<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>Piniaåˆä½“éªŒ | é…±è±†è…ç²¾çš„å°ç«™</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://luhaifeng666.github.io/favicon.ico?v=1643341491308">
<link rel="stylesheet" href="https://luhaifeng666.github.io/styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="å†™åœ¨å¼€å§‹
1æœˆ20æ—¥ï¼Œå°¤å¤§åœ¨çŸ¥ä¹å¹³å°å‘å¸ƒ Vue3 å°†è‡ª2æœˆ7æ—¥èµ·æˆä¸ºé»˜è®¤ç‰ˆæœ¬çš„æ¶ˆæ¯


Vue3 ç›¸å…³çš„æŠ€æœ¯æ ˆä¹Ÿå¯ä»¥å­¦ä¹ èµ·æ¥å•¦~æœ¬æ–‡å°±åŒå¤§å®¶ä¸€èµ·åˆæ­¥ä½“éªŒä¸‹ â€œä¸‹ä¸€ä»£çš„Vuexâ€ -- Piniaã€‚
ä»€ä¹ˆæ˜¯Pinia
Pinia ä»‹ç»
å¤§æ¦‚..." />
    <meta name="keywords" content="JS,å­¦ä¹ " />
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script>
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://luhaifeng666.github.io">
        <img src="https://luhaifeng666.github.io/images/avatar.png?v=1643341491308" class="site-logo">
        <h1 class="site-title">é…±è±†è…ç²¾çš„å°ç«™</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      æˆ‘å¹ï¼Œä½ å¬
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/luhaifeng666" target="_blank">é…±è±†è…ç²¾</a> | <a class="rss" href="https://luhaifeng666.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">Piniaåˆä½“éªŒ</h2>
            <div class="post-date">2022-01-28</div>
            
              <div class="feature-container" style="background-image: url('https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b97d9bf02b114c1bb6445b10b190f2be~tplv-k3u1fbpfcp-zoom-crop-mark:1304:1304:1304:734.awebp?')">
              </div>
            
            <div class="post-content" v-pre>
              <h1 id="å†™åœ¨å¼€å§‹">å†™åœ¨å¼€å§‹</h1>
<p>1æœˆ20æ—¥ï¼Œå°¤å¤§åœ¨çŸ¥ä¹å¹³å°å‘å¸ƒ <a href="https://zhuanlan.zhihu.com/p/460055155"><code>Vue3</code> å°†è‡ª2æœˆ7æ—¥èµ·æˆä¸ºé»˜è®¤ç‰ˆæœ¬</a>çš„æ¶ˆæ¯</p>
<!-- more -->
<figure data-type="image" tabindex="1"><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/690b04d56e8d4672bc59056611c95967~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></figure>
<p><code>Vue3</code> ç›¸å…³çš„æŠ€æœ¯æ ˆä¹Ÿå¯ä»¥å­¦ä¹ èµ·æ¥å•¦~æœ¬æ–‡å°±åŒå¤§å®¶ä¸€èµ·åˆæ­¥ä½“éªŒä¸‹ â€œä¸‹ä¸€ä»£çš„Vuexâ€ -- <a href="https://pinia.vuejs.org/">Pinia</a>ã€‚</p>
<h1 id="ä»€ä¹ˆæ˜¯pinia">ä»€ä¹ˆæ˜¯Pinia</h1>
<h2 id="pinia-ä»‹ç»">Pinia ä»‹ç»</h2>
<p>å¤§æ¦‚åœ¨2019å¹´11æœˆä»½å·¦å³ï¼ŒPinia çš„ä½œè€…å¼€å§‹å°è¯•é‡æ–°è®¾è®¡ Store çŠ¶æ€ç®¡ç†ä»¥é€‚ç”¨äº Composition APIï¼Œå…¶è®¾è®¡åŸåˆ™è·Ÿæ€æƒ³ä¸ Vuex ä¿æŒä¸€è‡´ã€‚</p>
<p>åœ¨ä¸åŒç‰ˆæœ¬çš„ Vue ä¸­ï¼Œæ‰€ä½¿ç”¨çš„ Vuex ç‰ˆæœ¬æ˜¯ä¸ä¸€æ ·çš„ã€‚Vue2 ä¸­éœ€è¦ä½¿ç”¨ Vuex 3.xçš„ç‰ˆæœ¬ï¼Œè€Œåœ¨ Vue3 ä¸­éœ€è¦ä½¿ç”¨ Vuex 4.xã€‚ä½†æ˜¯ Pinia æ²¡æœ‰è¿™ä¸ªé™åˆ¶ï¼Œæ— è®ºæ˜¯åœ¨ Vue2 ä¸­ï¼Œè¿˜æ˜¯åœ¨ Vue3 ä¸­å‡å¯ä»¥ä½¿ç”¨ Piniaï¼Œ<strong>ä¸”ä¸ä¸€å®šè¦ä¸ Composition API ä¸€èµ·ä½¿ç”¨</strong>ï¼ŒAPI çš„ä½¿ç”¨æ–¹å¼åœ¨ä¸¤è€…ä¸­ä¹Ÿæ˜¯ä¿æŒä¸€è‡´çš„ã€‚</p>
<p>ç°åœ¨ï¼ŒPinia ä¹Ÿå·²ç»æ­£å¼è¢«çº³å…¥ Vue å®˜æ–¹ä½“ç³»ä¸­ã€‚ç¬”è€…å†™è¿™ç¯‡æ–‡ç« æ—¶ï¼Œå…¶ç‰ˆæœ¬å·²æ›´æ–°è‡³ <strong>v2.0.9</strong> ã€‚</p>
<h2 id="ä¸ºå•¥è¦ç”¨-pinia">ä¸ºå•¥è¦ç”¨ Pinia</h2>
<p>Pinia æ˜¯ç”¨äº Vue ä¸­çš„çŠ¶æ€ç®¡ç†å™¨ï¼Œå…è®¸ä½ è·¨ç»„ä»¶/é¡µé¢å…±äº«çŠ¶æ€ã€‚</p>
<p>å¦‚æœå°ä¼™ä¼´ä»¬å·²ç»å¯¹ Composition API æ¯”è¾ƒç†Ÿæ‚‰äº†çš„è¯ï¼Œå¯èƒ½ä¼šè€ƒè™‘ä½¿ç”¨ç±»ä¼¼ä¸‹é¢è¿™ç§å†™æ³•å»å…±äº«å…¨å±€çŠ¶æ€ï¼š</p>
<pre><code class="language-vue">export const state = reactive({})
</code></pre>
<p>åœ¨ SPA åº”ç”¨ä¸­ï¼Œè¿™æ ·å»åšæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯å¦‚æœæ˜¯åœ¨ SSR ä¸­å»ä½¿ç”¨çš„è¯ä¼šå­˜åœ¨å®‰å…¨éšæ‚£ã€‚æ‰€ä»¥è¿˜æ˜¯å»ºè®®ä½¿ç”¨ Piniaã€‚</p>
<p>ä½¿ç”¨ Pinia æœ‰ä»¥ä¸‹å¥½å¤„ï¼š</p>
<ol>
<li>
<p><strong>è°ƒè¯•å·¥å…·æ”¯æŒ</strong></p>
<p>ç¬”è€…ç›®å‰å®‰è£…çš„æ˜¯ beta ç‰ˆæœ¬çš„ Vue devtoolï¼Œå°ä¼™ä¼´ä»¬å¯ä»¥å» <a href="chrome://extensions">è°·æ­Œåº”ç”¨å•†åº—</a> ä¸­æœç´¢ <code>Vue devtool</code> ä¸‹è½½å¯¹åº”çš„ beta ç‰ˆæœ¬ã€‚</p>
</li>
</ol>
<figure data-type="image" tabindex="2"><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8acca1566bfe4502bc35cee45a4f0589~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></figure>
<blockquote>
<ol>
<li>è°ƒè¯•å·¥å…·ä¸­æ”¯æŒè¿½è¸ª actionsï¼Œmutations çš„timeline(æ—¶é—´çº¿)ï¼›</li>
<li>å¯ä»¥æ˜¾ç¤ºå½“å‰ç»„ä»¶ä¸­ä½¿ç”¨çš„ store ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥æ˜¾ç¤ºæ‰€æœ‰ store å®¹å™¨çš„ä¿¡æ¯ï¼Œæ”¯æŒç›´æ¥ä¿®æ”¹æ•°æ®è¿›è¡Œè°ƒè¯•ï¼›</li>
<li>æ”¯æŒ Time travel(æ—¶é—´æ—…è¡Œ) ä»¥æ–¹ä¾¿è°ƒè¯•ã€‚</li>
</ol>
</blockquote>
<ol start="2">
<li><strong>çƒ­æ¨¡å—æ›¿æ¢</strong>ï¼šæ”¹å˜çŠ¶æ€æ—¶æ— éœ€æ‰‹åŠ¨åˆ·æ–°é¡µé¢ã€‚</li>
<li><strong>æ’ä»¶æ”¯æŒ</strong>ï¼šå¯ä»¥é€šè¿‡æ’ä»¶æ‰©å±• Pinia çš„èƒ½åŠ›ã€‚</li>
<li><strong>è‰¯å¥½çš„ Typescript æ”¯æŒ</strong>ï¼šå¯ä»¥æä¾›è¾ƒä¸ºå®Œå–„çš„ä»£ç æç¤ºä»¥åŠä»£ç è‡ªåŠ¨è¡¥å……ã€‚</li>
<li><strong>æ”¯æŒ SSR</strong>ã€‚</li>
</ol>
<h2 id="pinia-ä¸-vuex-çš„å¯¹æ¯”">Pinia ä¸ Vuex çš„å¯¹æ¯”</h2>
<p>Pinia ä¸ Vuex4.x ä»¥ä¸‹ç‰ˆæœ¬ç›¸æ¯”ï¼Œæœ‰å¦‚ä¸‹åŒºåˆ«ï¼š</p>
<blockquote>
<ol>
<li><strong>ç§»é™¤äº† mutations</strong>ï¼š åœ¨ Vuex ä¸­ï¼Œæƒ³è¦æ”¹å˜çŠ¶æ€ï¼Œéœ€è¦é€šè¿‡æäº¤ mutations æ¥å®ç°ï¼Œè€Œ mutations ä¸èƒ½æ‰§è¡Œå¼‚æ­¥æ“ä½œï¼Œå› æ­¤è¯ç”Ÿäº† actions ï¼Œåœ¨å¼‚æ­¥è·å–æ•°æ®åï¼Œé€šè¿‡ actions è°ƒç”¨ mutations ä¿®æ”¹æ•°æ®ã€‚ç°åœ¨åœ¨ Pinia ä¸­ï¼Œactions åŒæ—¶æ”¯æŒåŒæ­¥ä¸å¼‚æ­¥æ“ä½œï¼Œæ‰€ä»¥ mutations æ˜¾å¾—æœ‰äº›å†—ä½™äº†ï¼Œå› æ­¤ä¸å†éœ€è¦ï¼›</li>
<li><strong>å¯¹äº Typescript çš„æ”¯æŒæ›´åŠ å‹å¥½</strong>ï¼šä½¿ç”¨ Pinia æ—¶,ä¸å†éœ€è¦å®šä¹‰å¤æ‚çš„ wrappersï¼ˆåŒ…è£…å™¨ï¼‰å»æ”¯æŒTypescript;</li>
<li><strong>ä¸ä¼šæ³¨å…¥é­”æ³•å­—ç¬¦ä¸²</strong>ï¼šåœ¨ç»„ä»¶ä¸­ä½¿ç”¨ Vuex æ—¶ï¼Œç»å¸¸ä¼šå‡ºç°ç±»ä¼¼ <code>this.$store.commit(&quot;xxxxx&quot;)</code> è¿™æ ·çš„é­”æ³•å­—ç¬¦ä¸²ï¼Œè™½ç„¶ä¼šå°†è¿™äº›å­—ç¬¦ä¸²æŠ½ä¸ºå¸¸é‡æš´éœ²å‡ºæ¥ï¼Œä½†æ˜¯ç»´æŠ¤èµ·æ¥è¿˜æ˜¯ä¸å¤ªæ–¹ä¾¿ã€‚åœ¨ Pinia ä¸­ä¸å†éœ€è¦ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œè€Œæ˜¯ç›´æ¥è°ƒç”¨ <code>defineStore</code> åæš´éœ²å‡ºæ¥çš„æ–¹æ³•ï¼Œè€Œåé€šè¿‡ <code>$patch</code>, <code>action</code> çš„æ–¹å¼ï¼Œæˆ–è€…ç›´æ¥ä¿®æ”¹ store ä¸­çš„å€¼å³å¯ï¼›</li>
<li><strong>ä¸éœ€è¦åŠ¨æ€æ·»åŠ  stores</strong>ï¼šåªè¦ä½ æ„¿æ„ï¼Œä½ å¯ä»¥éšæ—¶å®šä¹‰ storesï¼Œå®ƒä»¬é»˜è®¤æ˜¯åŠ¨æ€çš„ï¼›</li>
<li><strong>ä¸å†éœ€è¦åµŒå¥—ç»“æ„çš„ modules</strong>;</li>
<li><strong>æ²¡æœ‰å¸¦å‘½åç©ºé—´çš„æ¨¡å—</strong>ã€‚</li>
</ol>
</blockquote>
<h1 id="pinaçš„ä½¿ç”¨">Pinaçš„ä½¿ç”¨</h1>
<h2 id="å®‰è£…">å®‰è£…</h2>
<p>æˆ‘ä»¬å…ˆåœ¨æœ¬åœ°æ­å»ºä¸€ä¸ªVue3çš„é¡¹ç›®ï¼Œç”¨äºæ¼”ç¤º <code>Pinia</code> çš„ä½¿ç”¨ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ <a href="https://cn.vitejs.dev/">Vite</a> æ¥æ­å»ºï¼š</p>
<blockquote>
<p>Vite éœ€è¦Â <a href="https://nodejs.org/en/">Node.js</a>Â ç‰ˆæœ¬ &gt;= 12.0.0ã€‚ç„¶è€Œï¼Œæœ‰äº›æ¨¡æ¿éœ€è¦ä¾èµ–æ›´é«˜çš„ Node ç‰ˆæœ¬æ‰èƒ½æ­£å¸¸è¿è¡Œï¼Œå½“ä½ çš„åŒ…ç®¡ç†å™¨å‘å‡ºè­¦å‘Šæ—¶ï¼Œè¯·æ³¨æ„å‡çº§ä½ çš„ Node ç‰ˆæœ¬ã€‚</p>
</blockquote>
<p>Viteå®˜æ–¹æä¾›äº†ä½¿ç”¨æ¨¡æ¿çš„æ–¹å¼æ„å»ºæœ¬åœ°é¡¹ç›®ï¼Œè¿™é‡Œæˆ‘ä»¬é€šè¿‡ <a href="https://www.pnpm.cn/">pnpm</a> æ¥æ„å»ºä¸€ä¸ª <code>Vite + Vue</code> çš„æœ¬åœ°é¡¹ç›®ã€‚ç°åœ¨ Vue3 ä»¥åŠ Pinia å¯¹äº Typescript çš„æ”¯æŒå·²ç»éå¸¸è‰¯å¥½äº†,å»ºè®®å¤§å®¶åœ¨ä½¿ç”¨æ¨¡æ¿æ„å»ºé¡¹ç›®çš„æ—¶å€™ç›´æ¥é€‰æ‹© Typescript å¯¹åº”çš„æ¨¡æ¿ï¼š</p>
<pre><code>pnpm create vite pinia-useage-examples -- --template vue-ts
</code></pre>
<p>ä¹‹åï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®ä¸­å®‰è£… <code>Pinia</code>:</p>
<pre><code> pnpm add pinia
</code></pre>
<p>å‡†å¤‡å·¥ä½œå®Œæˆï¼Œæ¥ä¸‹æ¥å°±æ¥ä¸€èµ·ä½“éªŒä¸€ä¸‹ <code>Pinia</code> å§~</p>
<h2 id="ä½¿ç”¨">ä½¿ç”¨</h2>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ <code>createPinia</code> åˆå§‹åŒ– Piniaï¼Œå¹¶å°†å…¶æŒ‚è½½åˆ° Vue çš„å®ä¾‹ä¸Šï¼š</p>
<pre><code class="language-ts">// src/main.ts

import { createApp } from 'vue'
import { createPinia } from 'pinia'
import App from './App.vue'

// åˆ›å»º pinia
const pinia = createPinia()

const app = createApp(App)
// æŒ‚è½½åˆ° Vue å®ä¾‹ä¸Š
app.use(pinia)
app.mount('#app')
</code></pre>
<p>ä¹‹åæŒ‰ç…§æƒ¯ä¾‹ï¼Œæˆ‘ä»¬å…ˆåˆ›å»º <code>src/store/index.ts</code> æ–‡ä»¶ï¼Œç”¨äºå­˜æ”¾ store:</p>
<pre><code class="language-ts">// src/store/index.ts

import { defineStore } from 'pinia'

// å®šä¹‰store, myFirstStoreæ˜¯storeçš„åç§°ï¼Œè¯¥åç§°å¿…é¡»å”¯ä¸€ï¼Œä¸å¯é‡å¤
export const useStore = defineStore('myFirstStore', {
  
})
</code></pre>
<p><strong>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>defineStore</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°ç”¨äºè®¾ç½® store çš„å®¹å™¨åç§°ï¼Œè¯¥åç§°å¿…é¡»å”¯ä¸€ï¼Œä¸å¯é‡å¤ï¼</strong></p>
<p>ä¸Šæ–‡ä¸­æåˆ°ï¼Œç›¸æ¯”äº Vuexï¼ŒPinia ä¸­ç§»é™¤äº† mutationsï¼Œå‰©ä½™éœ€è¦äº†è§£çš„å†…å®¹ä¸»è¦åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ï¼š</p>
<blockquote>
<ol>
<li><strong>State</strong>: ç”¨äºå­˜æ”¾æ•°æ®ï¼Œæœ‰ç‚¹å„¿ç±»ä¼¼ <code>data</code> çš„æ¦‚å¿µï¼›</li>
<li><strong>Getters</strong>: ç”¨äºè·å–æ•°æ®ï¼Œæœ‰ç‚¹å„¿ç±»ä¼¼ <code>computed</code> çš„æ¦‚å¿µï¼›</li>
<li><strong>Actions</strong>: ç”¨äºä¿®æ”¹æ•°æ®ï¼Œæœ‰ç‚¹å„¿ç±»ä¼¼ <code>methods</code> çš„æ¦‚å¿µï¼›</li>
<li><strong>Plugins</strong>: Pinia æ’ä»¶ã€‚</li>
</ol>
</blockquote>
<p>ç°åœ¨æˆ‘ä»¬ä¾æ¬¡æ¥çœ‹ä¸€çœ‹å®ƒä»¬çš„ç”¨æ³•ã€‚</p>
<h2 id="state">State</h2>
<h3 id="å®šä¹‰-state">å®šä¹‰ State</h3>
<p>åœ¨ Vuex ä¸­ï¼Œé€šè¿‡å¯¹è±¡çš„å½¢å¼æ¥å®šä¹‰ state ï¼Œè€Œåœ¨ Pinia ä¸­åˆ™éœ€è¦é€šè¿‡å‡½æ•°çš„æ–¹å¼å®šä¹‰ stateï¼Œè¿™ç§æ–¹å¼æœ‰ç‚¹å„¿ç±»ä¼¼ç»„ä»¶ä¸­ <code>data</code> çš„æ¦‚å¿µ:</p>
<pre><code class="language-ts">// src/store/index.ts

import { defineStore } from 'pinia'

// å®šä¹‰store, myFirstStoreæ˜¯storeçš„åç§°ï¼Œè¯¥åç§°å¿…é¡»å”¯ä¸€ï¼Œä¸å¯é‡å¤
export const useStore = defineStore('myFirstStore', {
  state: () =&gt; {
    return {
      count: 0,
      name: 'foo',
      list: [1, 2, 3]
    }
  }
})
</code></pre>
<h3 id="è¯»å–-state">è¯»å– State</h3>
<p>state å®šä¹‰å®Œæˆåï¼Œæˆ‘ä»¬åœ¨é¡µé¢ä¸­å¯ä»¥é€šè¿‡å¼•å…¥æš´éœ²å‡ºå»çš„ <code>useStore</code> æ¥è¯»å– state ä¸­çš„æ•°æ®ï¼š</p>
<pre><code class="language-js">// src/App.vue

&lt;template&gt;
  &lt;p&gt;count: {{ myStore.count }}&lt;/p&gt;
  &lt;p&gt;name: {{ myStore.name }}&lt;/p&gt;
  &lt;p&gt;list: {{ myStore.list }}&lt;/p&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import { useStore } from './store'

const myStore = useStore()
&lt;/script&gt;
</code></pre>
<p>çœ‹åˆ°è¿™é‡Œï¼Œæœ‰çš„å°ä¼™ä¼´ä¸ç¦ä¼šé—®ï¼Œåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œä¸€ç›´è¦å†™ <code>myStore.xxx</code> ä¸æ˜¯å¾ˆéº»çƒ¦ä¹ˆï¼Ÿèƒ½å¦é€šè¿‡è§£æ„çš„æ–¹å¼æ¥ä½¿ç”¨å‘¢ï¼Ÿ</p>
<p>é‚£æˆ‘ä»¬å°±ä¸€èµ·æ¥è¯•ä¸€è¯•ï¼Œçœ‹çœ‹æ˜¯å¦å¯ä»¥é€šè¿‡è§£æ„çš„æ–¹å¼æ¥è·å– store ä¸­çš„å€¼:</p>
<pre><code class="language-js">// src/App.vue

&lt;template&gt;
  &lt;img alt=&quot;Vue logo&quot; src=&quot;./assets/logo.png&quot; /&gt;
  &lt;p&gt;count: {{ count }}&lt;/p&gt;
  &lt;p&gt;name: {{ name }}&lt;/p&gt;
  &lt;p&gt;list: {{ list }}&lt;/p&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import { useStore } from './store'

const { count, name, list } = useStore()
&lt;/script&gt;
</code></pre>
<p>é€šè¿‡è¿™æ¬¡å°è¯•æˆ‘ä»¬å‘ç°ï¼Œç¡®å®å¯ä»¥é€šè¿‡è§£æ„çš„æ–¹å¼æ¥è·å–åˆ° store çš„å€¼ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼š<strong>ç›´æ¥é€šè¿‡è§£æ„çš„æ–¹å¼è·å–stateä¸­çš„å€¼æ˜¯éå“åº”å¼çš„ï¼</strong> è¿™å°±æ„å‘³ç€åé¢åœ¨å¯¹ store ä¸­çš„å€¼è¿›è¡Œä¿®æ”¹ä¹‹åï¼Œé¡µé¢ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚</p>
<p>é‚£æˆ‘ä»¬æ”¹å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿç­”æ¡ˆæ˜¯é€šè¿‡ Pinia ä¸­æä¾›çš„ <code>storeToRefs</code> æ–¹æ³•ï¼Œå°†ç»“æ„å‡ºæ¥çš„å€¼è½¬æ¢ä¸ºå“åº”å¼çš„å€¼å³å¯ï¼š</p>
<pre><code class="language-ts">// src/App.vue

&lt;script setup lang=&quot;ts&quot;&gt;
import { storeToRefs } from 'pinia'
import { useStore } from './store'

const { count, name, list } = storeToRefs(useStore())
&lt;/script&gt;
</code></pre>
<p>é™¤äº†ä½¿ç”¨è¿™ä¸¤ç§æ–¹å¼ä»¥å¤–ï¼ŒPinia ä¹Ÿæä¾›äº† <code>mapState</code> ä¸ <code>computed</code> ç›¸ç»“åˆçš„æ–¹å¼å»è·å– store ä¸­çš„å€¼ï¼Œè¿™ç§æ–¹å¼ä¸ Vuex ä¸­çš„ <code>mapState</code> ç±»ä¼¼ï¼š</p>
<pre><code class="language-js">// src/App.vue

&lt;template&gt;
  &lt;img alt=&quot;Vue logo&quot; src=&quot;./assets/logo.png&quot; /&gt;
  &lt;p&gt;count: {{ res.count }}&lt;/p&gt;
  &lt;p&gt;name: {{ res.name }}&lt;/p&gt;
  &lt;p&gt;list: {{ res.list }}&lt;/p&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import { mapState } from 'pinia'
import { useStore } from './store'
import { computed } from 'vue'

const res = computed(() =&gt; {
  const data = {
    ...mapState(useStore, ['count', 'name', 'list'])
  }
  return {
    count: data.count(),
    name: data.name(),
    list: data.list()
  }
})
&lt;/script&gt;
</code></pre>
<p>ç”±äºæ˜¯é€šè¿‡ <code>computed</code> è·å–åˆ°çš„å€¼ï¼Œæ‰€ä»¥ç»“æ„ä¹‹åçš„å€¼å°±æ˜¯å“åº”å¼çš„ï¼Œä¸éœ€è¦ä½¿ç”¨ <code>stateToRefs</code> æ–¹æ³•è¿›è¡Œè½¬æ¢ã€‚</p>
<p>åœ¨ <code>computed</code> å†…éƒ¨ä¹Ÿå¯ä»¥å¯¹å±æ€§è¿›è¡Œé‡å‘½åï¼Œæˆ–è€…é‡æ–°å®šä¹‰æ–°çš„è¿”å›å€¼è¿”å›å€¼ï¼š</p>
<pre><code class="language-js">&lt;script setup lang=&quot;ts&quot;&gt;
import { mapState } from 'pinia'
import { useStore } from './store'
import { computed } from 'vue'

const res = computed(() =&gt; {
  const data = {
    ...mapState(useStore, {
      // é‡å‘½åcountä¸ºmyCount, å¹¶è¿”å›count + 1çš„ç»“æœ
      myCount: state =&gt; state.count += 1,
      // é‡å‘½ånameä¸ºæ²¡æœ‰Nameï¼Œå¹¶è¿”å›nameçš„å€¼
      myName: 'name',
      // é‡å‘½ålistä¸ºmyListï¼Œå¹¶è¿”å›æ’å…¥4ä¹‹åçš„list
      myList: state =&gt; {
        state.list.push(4)
        return state.list
      }
    })
  }
  return {
    count: data.myCount(),
    name: data.myName(),
    list: data.myList()
  }
})
&lt;/script&gt;
</code></pre>
<blockquote>
<p><strong>æ³¨æ„ï¼š</strong></p>
<ol>
<li>æœ¬æ–‡çš„ç¤ºä¾‹ä¸­ä½¿ç”¨çš„æ˜¯ <code>setup</code> è¯­æ³•ç³–ï¼Œå¦‚æœä¸ä½¿ç”¨ <code>setup</code> è¯­æ³•ç³–çš„è¯ï¼Œ<code>mapState</code> çš„ä½¿ç”¨æ–¹å¼ä¸æœ¬æ–‡ä¸­æ‰€ä¸¾çš„ğŸŒ°æœ‰äº›å·®åˆ«(å…³äºè¿™ä¸ªé—®é¢˜ï¼Œç½‘ä¸Šæœ‰ä½¿ç”¨ <code>bind</code> çš„æ–¹å¼çš„æ —å­ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ<a href="https://blog.csdn.net/WaiTinglw/article/details/122091494">è¿™ç¯‡æ–‡ç« </a>)ã€‚è¯¦æƒ…å¯ä»¥æŸ¥é˜…<a href="https://pinia.vuejs.org/core-concepts/state.html#usage-with-the-options-api">å®˜æ–¹æ–‡æ¡£</a>ã€‚å¦‚æœæœ¬æ–‡ä¸­æœ‰ä½¿ç”¨ä¸å½“ä¹‹å¤„ï¼Œè¿˜è¯·è¯¸ä½å¤§ä½¬æŒ‡æ­£~ Orzï¼›</li>
<li>é€šè¿‡ <code>computed</code> è¿”å›çš„ state æ— æ³•ä½¿ç”¨ç»“æ„çš„æ–¹å¼è·å–å…¶ä¸­çš„å€¼ï¼Œå› ä¸ºè¿”å›çš„ä¸æ˜¯å•çº¯çš„å¯¹è±¡ï¼Œè€Œæ˜¯ä¸€ä¸ª <code>ComputedRefImpl</code> ç±»å‹çš„å€¼ã€‚</li>
<li>é€šè¿‡ <code>mapState</code> è·å–åˆ°çš„å€¼æ˜¯<strong>åªè¯»</strong>çš„ï¼Œå¦‚æœæƒ³è¦å…¶å¯å†™ï¼Œå¯ä»¥ä½¿ç”¨ <code>mapWritableState</code> çš„æ–¹å¼ã€‚</li>
</ol>
</blockquote>
<h3 id="ä¿®æ”¹-state">ä¿®æ”¹ State</h3>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»å¯ä»¥è·å–åˆ° State ä¸­å­˜å‚¨çš„å€¼äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯¥å¦‚ä½•å»ä¿®æ”¹ State ä¸­çš„å€¼å‘¢ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š</p>
<h4 id="ç¬¬ä¸€ç§ç›´æ¥ä¿®æ”¹">ç¬¬ä¸€ç§ï¼šç›´æ¥ä¿®æ”¹</h4>
<p>ç›´æ¥ä¿®æ”¹ State ä¸­çš„å€¼å³å¯ï¼š</p>
<pre><code class="language-js">// src/App.vue

&lt;template&gt;
  &lt;img alt=&quot;Vue logo&quot; src=&quot;./assets/logo.png&quot; /&gt;
  &lt;p&gt;count: {{ count }}&lt;/p&gt;
  &lt;button @click=&quot;handleChangeStore&quot;&gt;change store&lt;/button&gt;
&lt;/template&gt;

&lt;script lang=&quot;ts&quot; setup&gt;
import { useStore } from './store'

const store = useStore()
// ä¿®æ”¹storeä¸­çš„å€¼
const handleChangeStore = () =&gt; {
  // ç›´æ¥ä¿®æ”¹
  store.count += 1
}
&lt;/script&gt;
</code></pre>
<p>ç”šè‡³å¯ä»¥é€šè¿‡æš´åŠ›è¦†ç›– <code>$state</code> çš„æ–¹å¼å°†æ‰€æœ‰å€¼è¿›è¡Œæ›¿æ¢ä¿®æ”¹ï¼š</p>
<pre><code class="language-ts">// src/App.vue

// çœç•¥å¥½å¤šå¥½å¤šä»£ç ã€‚ã€‚ã€‚

// ç›´æ¥æ¸…ç©ºstore
store.$state = {}
</code></pre>
<h4 id="ç¬¬äºŒç§-é€šè¿‡-patch-çš„æ–¹å¼ä¿®æ”¹">ç¬¬äºŒç§: é€šè¿‡ <code>$patch</code> çš„æ–¹å¼ä¿®æ”¹</h4>
<p>å½“æˆ‘ä»¬éœ€è¦ä¸€æ¬¡æ€§ä¿®æ”¹å¤šä¸ªå€¼çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>$patch</code> æ–¹æ³•æ¥æ‰¹é‡ä¿®æ”¹å¤šä¸ªå€¼ï¼š</p>
<pre><code class="language-js">// src/App.vue

&lt;template&gt;
  &lt;img alt=&quot;Vue logo&quot; src=&quot;./assets/logo.png&quot; /&gt;
  &lt;p&gt;name: {{ name }}&lt;/p&gt;
  &lt;p&gt;list: {{ list }}&lt;/p&gt;
  &lt;button @click=&quot;handleChangeStore&quot;&gt;change store&lt;/button&gt;
&lt;/template&gt;

&lt;script lang=&quot;ts&quot; setup&gt;
import { useStore } from './store'

const store = useStore()

// ä¿®æ”¹storeä¸­çš„å€¼
const handleChangeStore = () =&gt; {
  // é€šè¿‡ $patch çš„æ–¹å¼ä¿®æ”¹
  store.$patch({
    name: 'test',
    list: [...store.list, 4]
  })
}
&lt;/script&gt;
</code></pre>
<p><code>$patch</code> ä¼šå°†ä¼ å…¥çš„å¯¹è±¡ä¸ Store ä¸­çš„ state è¿›è¡Œ merge è¦†ç›–ã€‚</p>
<p>é™¤äº†ç›´æ¥ä¼ å…¥å¯¹è±¡å¤–ï¼Œå¦‚æœå­˜åœ¨è¾ƒä¸ºå¤æ‚çš„æ“ä½œï¼Œ<code>$patch</code> æ–¹æ³•ä¹Ÿæ¥å—ä¼ å…¥ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œåœ¨å›è°ƒå‡½æ•°ä¸­å¯¹éœ€è¦ä¿®æ”¹çš„æ•°æ®è¿›è¡Œæ“ä½œï¼š</p>
<pre><code>// src/App.vue

// çœç•¥å¥½å¤šå¥½å¤šä»£ç ã€‚ã€‚ã€‚
store.$patch(state =&gt; {
  state.name = `æˆ‘çš„åå­—æ˜¯ï¼š${state.name}`
})

</code></pre>
<h4 id="ç¬¬ä¸‰ç§é€šè¿‡-reset-æ–¹æ³•æ¢å¤åŸå€¼">ç¬¬ä¸‰ç§ï¼šé€šè¿‡ <code>$reset</code> æ–¹æ³•æ¢å¤åŸå€¼</h4>
<p>å½“æˆ‘ä»¬ä¿®æ”¹äº† state ä¸­çš„å€¼ä»¥åï¼Œå€˜è‹¥æˆ‘ä»¬æƒ³è®©å®ƒä»¬æ¢å¤åˆ°åˆå§‹å€¼ï¼Œå¯ä»¥ä½¿ç”¨ <code>$reset</code> æ–¹æ³•ã€‚</p>
<h4 id="ç¬¬å››ç§é€šè¿‡è°ƒç”¨-actions-ä¸­çš„æ–¹æ³•å»ä¿®æ”¹å€¼">ç¬¬å››ç§ï¼šé€šè¿‡è°ƒç”¨ <code>actions</code> ä¸­çš„æ–¹æ³•å»ä¿®æ”¹å€¼</h4>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨ Store å®¹å™¨ä¸­å®šä¹‰ <code>actions</code>:</p>
<pre><code class="language-ts">// src/store/index.ts

// å®šä¹‰store
export const useStore = defineStore('myFirstStore', {
  // çœç•¥ä¸€äº›ä»£ç 
  actions: {
    changeCount () {
      this.count ++
    }
  }
})
</code></pre>
<p>åœ¨ <code>actions</code> ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ <code>this</code> æ¥è®¿é—® state ä¸­çš„å±æ€§ï¼Œè€Œæ— éœ€åƒ Vuex é‚£æ ·ä¼ å…¥ä¸Šä¸‹æ–‡æ‰å¯ä»¥ï¼Œä½¿ç”¨æ–¹å¼æœ‰ç‚¹å„¿ç±»ä¼¼ <code>methods</code>ã€‚</p>
<p>å®šä¹‰å®Œæˆåï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨å¼•ç”¨å¤„ç›´æ¥ä½¿ç”¨å®ƒäº†ï¼š</p>
<pre><code class="language-ts">// src/App.vue

&lt;template&gt;
  &lt;img alt=&quot;Vue logo&quot; src=&quot;./assets/logo.png&quot; /&gt;
  &lt;p&gt;count: {{ count }}&lt;/p&gt;
  &lt;button @click=&quot;handleChangeStore&quot;&gt;change store&lt;/button&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import { useStore } from './store'

const store = useStore()

// ä¿®æ”¹storeä¸­çš„å€¼
const handleChangeStore = () =&gt; {
  // é€šè¿‡actionsçš„æ–¹å¼ä¿®æ”¹
  store.changeCount()
}
&lt;/script&gt;
</code></pre>
<p>å½“ç„¶ï¼Œ<code>actions</code> ä¸­çš„æ–¹æ³•ä¹Ÿå¯ä»¥æ¥æ”¶å…¥å‚ï¼Œä½¿ç”¨æ–¹å¼ä¸ <code>methods</code> å¹¶æ— åŒºåˆ«ï¼Œè¿™é‡Œä¸åšè¿‡å¤šèµ˜è¿°ã€‚</p>
<h3 id="è°ƒè¯•-state">è°ƒè¯• State</h3>
<p>æ‰“å¼€æ§åˆ¶å°ï¼Œåˆ‡æ¢åˆ° Vue devtool ä¸­ï¼Œé€‰æ‹© <code>Pinia</code> é€‰é¡¹ï¼Œå°±å¯ä»¥çœ‹åˆ° store å®¹å™¨çš„ä¿¡æ¯ï¼š</p>
<figure data-type="image" tabindex="3"><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7e6e06b6634e4ec8bfdcac7aeaf3c55d~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></figure>
<p>å¹¶ä¸”ç‚¹å‡»æ•°æ®åé¢çš„ç¼–è¾‘æŒ‰é’®ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹ store ä¸­çš„å€¼è¿›è¡Œè°ƒè¯•ï¼Œéå¸¸æ–¹ä¾¿ï¼š</p>
<figure data-type="image" tabindex="4"><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c99a0e1af8e74eefa41784219996ad81~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></figure>
<h2 id="getters">Getters</h2>
<p><code>getters</code> çš„ä½¿ç”¨æ–¹å¼æœ‰ç‚¹å„¿ç±»ä¼¼äº <code>computed</code>, è¿”å›ä¸€ä¸ªå€¼(<strong>æ²¡æœ‰è¿”å›å€¼ä¹Ÿå¯ä»¥</strong>)ä¸”åœ¨é¡µé¢ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚å¦‚æœ <code>getters</code> ä¸­ä½¿ç”¨äº† <code>state</code> é‡Œçš„æ•°æ®ï¼Œå½“å¯¹åº”çš„æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œ<code>getters</code> çš„å€¼ä¹Ÿä¼šç›¸åº”å‘ç”Ÿå˜åŒ–ï¼š</p>
<pre><code class="language-ts">// src/store/index.ts

// å®šä¹‰store
export const useStore = defineStore('myFirstStore', {
  // çœç•¥ä¸€äº›ä»£ç 
  getters: {
    countPlusOne (state) {
      console.log('------countPlusOne------')
      return state.count + 1
    }
  }
})
</code></pre>
<p>ç›´æ¥åœ¨é¡µé¢ä¸­ä½¿ç”¨ï¼Œå¹¶ä¸” <code>getters</code> ä¹Ÿæœ‰ç¼“å­˜ï¼Œåœ¨é¡µé¢ä¸­å¤šæ¬¡ä½¿ç”¨æ—¶ï¼Œåªä¼šè®¡ç®—ä¸€æ¬¡ï¼š</p>
<pre><code class="language-ts">// src/App.vue

&lt;template&gt;
  &lt;p&gt;countPlusOne: {{ store.countPlusOne }}&lt;/p&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import { useStore } from './store'

const store = useStore()
&lt;/script&gt;
</code></pre>
<figure data-type="image" tabindex="5"><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/acf3831592af4344a1cfe7483c520ec6~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></figure>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ—¥å¿—åªæ‰“å°äº†ä¸€æ¬¡ï¼Œè¯´æ˜åé¢ä¸¤æ¬¡æ˜¯å–çš„ç¼“å­˜ä¸­çš„æ•°æ®ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼š</p>
<ol>
<li><code>getters</code> ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œå…¥å‚ <code>state</code> æ˜¯å¯é€‰å‚æ•°ï¼Œå¦‚æœä¸ä¼ å…¥ <code>state</code>, å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>this</code> è®¿é—® <code>state</code> ä¸­çš„æ•°æ®ï¼›</li>
<li>å¦‚æœä¸ä¼ å…¥ <code>state</code> çš„è¯ï¼ŒTypescript ä¼šæœ‰æŠ¥é”™æç¤ºï¼Œå› ä¸ºæ— æ³•æ¨å¯¼å‡º <code>getters</code> ä¸­æ–¹æ³•çš„è¿”å›å€¼ç±»å‹ï¼Œéœ€è¦æ‰‹åŠ¨å£°æ˜è¿”å›å€¼ç±»å‹ã€‚</li>
</ol>
</blockquote>
<h2 id="actions">Actions</h2>
<p>ä¸Šæ–‡ä¸­æåˆ°å¯ä»¥é€šè¿‡ <code>Actions</code> çš„æ–¹å¼ä¿®æ”¹ <code>State</code> ä¸­çš„å€¼ï¼Œåªä¸è¿‡æ‰€ä½¿ç”¨çš„æ˜¯åŒæ­¥çš„æ–¹å¼ã€‚åœ¨ä¸€å¼€å§‹å¯¹ Pinia çš„ä»‹ç»ä¸­ä¹Ÿæåˆ°ï¼Œ<code>Actions</code> åŒæ—¶æ”¯æŒåŒæ­¥ä¸å¼‚æ­¥ä¸¤ç§ä¿®æ”¹æ•°æ®çš„æ–¹å¼ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•é€šè¿‡ <code>Actions</code> å¼‚æ­¥ä¿®æ”¹æ•°æ®ã€‚</p>
<pre><code class="language-ts">// src/store/index.ts

// çœç•¥å¥½å¤šå¥½å¤šä»£ç ã€‚ã€‚ã€‚
actions: {
  async changeName () {
    const newName: string = await new Promise((resolve, reject) =&gt; {
      setTimeout(() =&gt; {
        resolve('newName')
      }, 1000)
    }).catch(err =&gt; {
    })
    this.name = newName
  }
}
</code></pre>
<p>é€šè¿‡ä¸Šè¿°ä»£ç æˆ‘ä»¬ä¸éš¾å‘ç°ï¼Œå…¶å® <code>Actions</code> é€šè¿‡å¼‚æ­¥ä¿®æ”¹æ•°æ®çš„æ–¹å¼ä¸å¯»å¸¸ä½¿ç”¨ <code>methods</code> å¼‚æ­¥ä¿®æ”¹ <code>data</code> ä¸­çš„æ•°æ®ç±»ä¼¼ï¼Œç›¸è¾ƒäº Vuex ç®€ä¾¿è®¸å¤šã€‚</p>
<h2 id="plugins">Plugins</h2>
<h3 id="æ’ä»¶ä»‹ç»">æ’ä»¶ä»‹ç»</h3>
<p>é€šè¿‡è‡ªå®šä¹‰ <code>Plugins</code> å¯ä»¥æ‰©å±• <code>Stores</code>ï¼Œå®ƒå¯ä»¥å®Œæˆä»¥ä¸‹è¿™äº›äº‹æƒ…ï¼š</p>
<blockquote>
<ol>
<li>æ–°å¢ <code>store</code> ä¸­çš„å±æ€§;</li>
<li>å®šä¹‰ <code>store</code> æ—¶ä¼ å…¥æ–°çš„é…ç½®é¡¹;</li>
<li>æ–°å¢ <code>store</code> ä¸­çš„æ–¹æ³•;</li>
<li>åŒ…è£… <code>store</code> ä¸­çš„æ—¢æœ‰æ–¹æ³•;</li>
<li>ä¿®æ”¹ç”šè‡³å–æ¶ˆ <code>actions</code>;</li>
<li>å®ç°ä¸€äº›å‰¯ä½œç”¨æ“ä½œï¼Œä¾‹å¦‚è®¾ç½® local storage ç¼“å­˜ç­‰ç­‰;</li>
<li>åªä¼šåº”ç”¨äºç‰¹å®šçš„ <code>store</code>: åœ¨ Pinia æŒ‚è½½åˆ° app ä¸Šåï¼Œæ’ä»¶ä¼šæŒ‚è½½åˆ°ä¹‹ååˆ›å»ºçš„ Stores ä¸Šï¼Œåœ¨æ­¤ä¹‹å‰ Plugins ä¸ä¼šè¢«æŒ‚è½½ã€‚</li>
</ol>
</blockquote>
<h3 id="æ’ä»¶å®šä¹‰-ä½¿ç”¨">æ’ä»¶å®šä¹‰ &amp; ä½¿ç”¨</h3>
<p>æ’ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ’ä»¶æ¥å—ä¸€ä¸ªå¯é€‰å…¥å‚ï¼š <code>context</code>, æ”¹å…¥å‚æ˜¯ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«å››é¡¹å†…å®¹ï¼š</p>
<ol>
<li><strong>context.pinia:</strong> é€šè¿‡ <code>createPinia()</code> æ–¹å¼åˆ›å»ºçš„ Pinia å®ä¾‹</li>
<li><strong>context.app:</strong> é€šè¿‡ <code>createApp()</code> æ–¹å¼åˆ›å»ºçš„ app å®ä¾‹(ä»…æ”¯æŒVue 3)</li>
<li><strong>context.store:</strong> store å¯¹è±¡</li>
<li><strong>context.options:</strong> è·å–å®šä¹‰ store æ—¶ä¼ å…¥çš„é…ç½®é¡¹</li>
</ol>
<p>å‡½æ•°å¯ä»¥é€šè¿‡è¿”å›å¯¹è±¡çš„æ–¹å¼ï¼Œå°†å¯¹è±¡ä¸­çš„å€¼ç»‘å®šåˆ°<strong>æ‰€æœ‰çš„</strong> store ä¸Šå»ï¼š</p>
<pre><code class="language-ts">// src/main.ts

function SecretPiniaPlugin() {
  return { secret: 'the cake is a lie' }
}
</code></pre>
<p>å®šä¹‰å®Œæˆåï¼Œé€šè¿‡ <code>pinia.use()</code> çš„æ–¹å¼ä½¿ç”¨è¿™ä¸ªæ’ä»¶ï¼š</p>
<pre><code class="language-ts">// src/main.ts
import { createPinia } from 'pinia'

const pinia = createPinia()

pinia.use(SecretPiniaPlugin)
</code></pre>
<p>ä¹‹åï¼Œåœ¨é¡µé¢ä¸­æ‰“å° Store ä¸­çš„ <code>secret</code> å±æ€§æ—¶ï¼Œå³å¯çœ‹åˆ°æˆ‘ä»¬è®¾å®šçš„å€¼ã€‚å¹¶ä¸”é€šè¿‡è¿™ç§æ–¹å¼æ–°å¢åˆ° store ä¸­çš„å±æ€§å¯ä»¥è¢« Vue devtool æ•è·åˆ°ï¼š</p>
<figure data-type="image" tabindex="6"><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fa5de1b7353e4de3b4a5deca838997c2~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></figure>
<p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥é€‰æ‹©ç›´æ¥å°†å€¼ç»‘å®šåˆ° store å¯¹è±¡ä¸Šï¼Œä½†æ˜¯è¿™æ ·<strong>æ— æ³•è¢« Vue devtoolæ•è·</strong>ï¼š</p>
<pre><code class="language-ts">// src/main.ts

// å®šä¹‰æ’ä»¶
function SecretPiniaPlugin({ store }) {
  // ç›´æ¥å°†å±æ€§ç»‘å®šåˆ°storeä¸Šå»
  store.secret = 'the cake is a lie'
}
</code></pre>
<figure data-type="image" tabindex="7"><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a7178d567ae64a8d9a61e9c40bb0a93a~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></figure>
<p>æ­¤æ—¶æˆ‘ä»¬ä¸éš¾å‘ç°ï¼Œä¸Šè¿°æ­¥éª¤ä¸­çš„ <code>customProperties</code> å±æ€§ä¸è§äº†ã€‚å¦‚æœåœ¨è°ƒè¯•è¿‡ç¨‹ä¸­éœ€è¦åœ¨ Vue devtool ä¸­çœ‹åˆ°æ’ä»¶ä¸­å®šä¹‰çš„ store å†…å®¹ï¼Œéœ€è¦æ‰‹åŠ¨æ·»åŠ ï¼š</p>
<pre><code class="language-ts">// src/main.ts

// å®šä¹‰æ’ä»¶
function SecretPiniaPlugin({ store }) {
  // ç›´æ¥å°†å±æ€§ç»‘å®šåˆ°storeä¸Šå»
  store.secret = 'the cake is a lie'
  // åœ¨å¼€å‘ç¯å¢ƒä¸­æ‰‹åŠ¨æ·»åŠ è¯¥å±æ€§ï¼Œä»¥ä¾¿ Vue devtool å¯ä»¥æ•è·åˆ°
  if (process.env.NODE_ENV === 'development') {
    // add any keys you set on the store
    store._customProperties.add('secret')
  }
}
</code></pre>
<p>æ·»åŠ å®Œå±æ€§åï¼Œå½“æˆ‘ä»¬ç›´æ¥åœ¨é¡µé¢ä¸­ä½¿ç”¨æ—¶ï¼Œå‘ç°é¡µé¢ä¸Šå¹¶ä¸èƒ½æ˜¾ç¤ºå‡ºæ’ä»¶æ’å…¥åˆ° store ä¸­çš„å±æ€§ï¼Œè¿™æ˜¯å› ä¸ºæ’å…¥çš„å±æ€§æ˜¯<strong>éå“åº”å¼çš„</strong>ï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬åªéœ€å°†æ’å…¥çš„å±æ€§å€¼å˜ä¸º<strong>å“åº”å¼æ•°æ®</strong>å³å¯ï¼š</p>
<pre><code class="language-ts">import { createApp, ref } from 'vue'
import { createPinia } from 'pinia'

// åˆ›å»º pinia
const pinia = createPinia()

// å®šä¹‰æ’ä»¶
function SecretPiniaPlugin({ store }) {
  // ç›´æ¥å°†å±æ€§ç»‘å®šåˆ°storeä¸Šå»
  store.secret = ref('the cake is a lie')
  // åœ¨å¼€å‘ç¯å¢ƒä¸­æ‰‹åŠ¨æ·»åŠ è¯¥å±æ€§ï¼Œä»¥ä¾¿ Vue devtool å¯ä»¥æ•è·åˆ°
  if (process.env.NODE_ENV === 'development') {
    // add any keys you set on the store
    store._customProperties.add('secret')
  }
}

// ä½¿ç”¨æ’ä»¶
pinia.use(SecretPiniaPlugin)
</code></pre>
<p>è®¾ç½®å®Œæˆåï¼Œå†åœ¨é¡µé¢ä¸­ä½¿ç”¨æ—¶ï¼Œå°±å¯ä»¥åœ¨é¡µé¢ä¸Šçœ‹åˆ°æ•°æ®å•¦~</p>
<p>æ­¤å¤–ï¼Œåœ¨æ’ä»¶ä¸­å¯ä»¥é€šè¿‡ <code>store.$subscribe</code> ä»¥åŠ <code>store.$onActions</code> æ–¹æ³•ç›‘å¬ actions çš„è§¦å‘ã€‚</p>
<p>å…³äºæ’ä»¶çš„æ›´å¤šç©æ³•å¯ä»¥å‚è€ƒ<a href="https://pinia.vuejs.org/core-concepts/plugins.html">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p>
<h1 id="å†™åœ¨æœ€å">å†™åœ¨æœ€å</h1>
<p>è¡Œæ–‡è‡³æ­¤ï¼Œç›¸ä¿¡å¤§å®¶å¯¹äº <code>Pinia</code> å·²ç»æœ‰äº†ä¸€ä¸ªåˆæ­¥çš„å°è±¡ã€‚æ–‡ç« ä¸­è‹¥æœ‰æè¿°ä¸å½“ä¹‹å¤„è¿˜è¯·è¯¸ä½å¤§ä½¬æŒ‡æ­£ã€‚</p>
<p>å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ï¼Œå…³äº Pinia çš„å…¶ä»–æ›´å¤šç©æ³•ç­‰å¾…ç€å°ä¼™ä¼´ä»¬å»æŒ–æ˜ã€‚èµ¶å¿«åŠ¨æ‰‹ <s>å·èµ·æ¥</s> å°ä¸ªé²œå§~</p>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://luhaifeng666.github.io/tag/h8BL6mwKM/" class="tag">
                    JS
                  </a>
                
                  <a href="https://luhaifeng666.github.io/tag/grwpKLl9t/" class="tag">
                    å­¦ä¹ 
                  </a>
                
              </div>
            
            <div id="vcomments"></div>
            <span id="comment-count"></span>
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://luhaifeng666.github.io/post/shou-xie-lian-xi-fang-dou-jie-liu/">
                  <h3 class="post-title">
                    æ‰‹å†™ç»ƒä¹ ï¼šé˜²æŠ–èŠ‚æµ
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>
    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>





  </body>
  <script type="text/javascript">
    // è®¾ç½®valine
    new Valine({
      av: AV,
      el: '#vcomments',
      count_el: '#comment-count',
      appId: 'HlwrEhBsDstpVpKVMUMqyfBV-9Nh9j0Va',
      appKey: 'Cs2jEIpcC6nXJFH8LsEak9Kh',
      placeholder: 'ä½ è¯´ï¼Œæˆ‘åœ¨å¬',
      visitor: true,
      // è®¾ç½®Bilibiliè¡¨æƒ…åŒ…åœ°å€
      emojiCDN: '//i0.hdslb.com/bfs/emote/',
      // è¡¨æƒ…titleå’Œå›¾ç‰‡æ˜ å°„
      emojiMaps: {
        "tv_doge": "6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png",
        "tv_äº²äº²": "a8111ad55953ef5e3be3327ef94eb4a39d535d06.png",
        "tv_å·ç¬‘": "bb690d4107620f1c15cff29509db529a73aee261.png",
        "tv_å†è§": "180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png",
        "tv_å†·æ¼ ": "b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png",
        "tv_å‘æ€’": "34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png",
        "tv_å‘è´¢": "34db290afd2963723c6eb3c4560667db7253a21a.png",
        "tv_å¯çˆ±": "9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png",
        "tv_åè¡€": "09dd16a7aa59b77baa1155d47484409624470c77.png",
        "tv_å‘†": "fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png",
        "tv_å‘•å": "9f996894a39e282ccf5e66856af49483f81870f3.png",
        "tv_å›°": "241ee304e44c0af029adceb294399391e4737ef2.png",
        "tv_åç¬‘": "1f0b87f731a671079842116e0991c91c2c88645a.png",
        "tv_å¤§ä½¬": "093c1e2c490161aca397afc45573c877cdead616.png",
        "tv_å¤§å“­": "23269aeb35f99daee28dda129676f6e9ea87934f.png",
        "tv_å§”å±ˆ": "d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png",
        "tv_å®³ç¾": "a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png",
        "tv_å°´å°¬": "7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png",
        "tv_å¾®ç¬‘": "70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png",
        "tv_æ€è€ƒ": "90cf159733e558137ed20aa04d09964436f618a1.png",
        "tv_æƒŠå“": "0d15c7e2ee58e935adc6a7193ee042388adc22af.png"
      }
    })
  </script>
</html>
