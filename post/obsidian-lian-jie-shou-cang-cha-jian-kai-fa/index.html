<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>Obsidian é“¾æ¥æ”¶è—æ’ä»¶å¼€å‘ | é…±è±†è…ç²¾çš„å°ç«™</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://luhaifeng666.github.io/favicon.ico?v=1649838062513">
<link rel="stylesheet" href="https://luhaifeng666.github.io/styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="æœ€è¿‘åœ¨ä½¿ç”¨ä¸€æ¬¾ Markdown ç¬”è®°åº”ç”¨: Obsidianï¼ŒåŠ ä¹‹å…ˆå‰åšäº†ä¸€ä¸ªå¯ä»¥å¿«æ·æ”¶è—/è·³è½¬åœ°å€çš„å·¥å…·: efficient-toolsï¼Œäºæ˜¯è¿™æ¬¡æ‰“ç®—æ’¸ä¸ª Obsidian çš„æ’ä»¶ï¼Œå€Ÿç”¨ Obsidian ç»™è¿™ä¸ªå°åŠŸèƒ½æä¾›å¯è§†åŒ–ç•Œé¢æ“..." />
    <meta name="keywords" content="å¼€å‘å·¥å…·" />
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script>
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://luhaifeng666.github.io">
        <img src="https://luhaifeng666.github.io/images/avatar.png?v=1649838062513" class="site-logo">
        <h1 class="site-title">é…±è±†è…ç²¾çš„å°ç«™</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      æˆ‘å¹ï¼Œä½ å¬
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/luhaifeng666" target="_blank">é…±è±†è…ç²¾</a> | <a class="rss" href="https://luhaifeng666.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">Obsidian é“¾æ¥æ”¶è—æ’ä»¶å¼€å‘</h2>
            <div class="post-date">2022-04-12</div>
            
              <div class="feature-container" style="background-image: url('https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f19ad09a1ec04852872bf1f6a44e9f17~tplv-k3u1fbpfcp-zoom-crop-mark:1304:1304:1304:734.awebp?')">
              </div>
            
            <div class="post-content" v-pre>
              <p>æœ€è¿‘åœ¨ä½¿ç”¨ä¸€æ¬¾ Markdown ç¬”è®°åº”ç”¨: <a href="https://obsidian.md/">Obsidian</a>ï¼ŒåŠ ä¹‹å…ˆå‰åšäº†ä¸€ä¸ªå¯ä»¥å¿«æ·æ”¶è—/è·³è½¬åœ°å€çš„å·¥å…·: <a href="https://www.npmjs.com/package/efficient-tools">efficient-tools</a>ï¼Œäºæ˜¯è¿™æ¬¡æ‰“ç®—æ’¸ä¸ª Obsidian çš„æ’ä»¶ï¼Œå€Ÿç”¨ Obsidian ç»™è¿™ä¸ªå°åŠŸèƒ½æä¾›å¯è§†åŒ–ç•Œé¢æ“ä½œçš„èƒ½åŠ›ï¼ˆèµ‹ã€‚ã€‚ã€‚ã€‚èƒ½ï¼Ÿï¼‰ã€‚</p>
<!-- more -->
<h1 id="å¼€å§‹">å¼€å§‹</h1>
<p>åœ¨ <strong>efficient-tools</strong> ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œçš„æ–¹å¼æ·»åŠ ã€åˆ é™¤ä»¥åŠæŸ¥çœ‹å¹¶è·³è½¬é“¾æ¥ï¼Œæ—¢ç„¶å¦‚æ­¤ï¼Œé‚£åœ¨è¿™ä¸ªæ’ä»¶ä¸­ä¹Ÿéœ€è¦å®ç°è¿™ä¸‰ç§åŠŸèƒ½ã€‚</p>
<h2 id="å‡†å¤‡å·¥ä½œ">å‡†å¤‡å·¥ä½œ</h2>
<p>åœ¨å¼€å§‹å¼€å‘ä¹‹å‰ï¼Œå…ˆè¦åšå¦‚ä¸‹å‡†å¤‡å·¥ä½œï¼š</p>
<blockquote>
<ol>
<li>å» <a href="https://obsidian.md/">Obsidian å®˜ç½‘</a> ä¸‹è½½ Obsidian åº”ç”¨ï¼›</li>
<li>å‚ç…§ <a href="https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh/getting-started/create-your-first-plugin.html#%E5%BC%80%E5%8F%91%E5%89%8D%E5%87%86%E5%A4%87">åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªæ’ä»¶</a> è¿™ç¯‡æ–‡æ¡£å‡†å¤‡å¥½å¼€å‘ç¯å¢ƒï¼Œå¹¶å°†æ’ä»¶åç§°æ”¹ä¸º <strong>obsidian-link-keeper</strong> ï¼›</li>
<li>ç”±äº Obsidian çš„æ’ä»¶åœ¨å¼€å‘è¿‡ç¨‹ä¸­åªèƒ½é€šè¿‡åœç”¨/å¯ç”¨æ’ä»¶çš„æ–¹å¼è®©æœ€æ–°çš„ä»£ç ç”Ÿæ•ˆï¼Œä¸ºäº†é¿å¼€è¿™ä¸ªç¹ççš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <a href="https://github.com/pjeby/hot-reload">Hot-Relod</a> è¿™ä¸ªå·¥å…·æ¥è®©æˆ‘ä»¬çš„æ’ä»¶å¯ä»¥çƒ­é‡è½½ã€‚</li>
</ol>
</blockquote>
<p>åœ¨åšå®Œä¸Šè¿°å‡†å¤‡å·¥ä½œåï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç›®å½•ç»“æ„:</p>
<pre><code>â”œâ”€â”€ README.md
â”œâ”€â”€ esbuild.config.mjs
â”œâ”€â”€ main.ts // å…¥å£æ–‡ä»¶
â”œâ”€â”€ manifest.json // æ’ä»¶çš„åŸºæœ¬ä¿¡æ¯
â”œâ”€â”€ modals.ts // ç”¨äºåˆ›å»ºæ¨¡æ€æ¡†
â”œâ”€â”€ node_modules
â”œâ”€â”€ package.json
â”œâ”€â”€ pnpm-lock.yaml
â”œâ”€â”€ styles.css // æ ·å¼æ–‡ä»¶
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ version-bump.mjs
â””â”€â”€ versions.json
</code></pre>
<h2 id="è®¾ç½®filepath">è®¾ç½®filepath</h2>
<p>åœ¨ <strong>efficient-tools</strong> ä¸­ï¼Œæ–°å¢çš„åœ°å€ä¼šé»˜è®¤ä¿å­˜åˆ° <strong><code>${process.env.HOME}/etl.json</code></strong> æ–‡ä»¶ä¸­ï¼Œåœ¨ Obsidian ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç»™æ’ä»¶æ·»åŠ é…ç½®çš„æ–¹å¼æ¥è®¾ç½®ä¿å­˜åœ°å€çš„æ–‡ä»¶è·¯å¾„ã€‚</p>
<p>Obsidian ä¸­æä¾›äº† <a href="https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh/api/classes/Setting.html#setting">Setting</a> ç±»ä»¥åˆ›å»ºè¯¸å¦‚æ–‡æœ¬æ¡†ï¼Œä¸‹æ‹‰æ¡†ï¼Œæ»‘åŠ¨æ¡ï¼ŒæŒ‰é’®ç­‰è¡¨å•æ§ä»¶ï¼Œä»¥åŠ <a href="https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh/api/classes/PluginSettingTab.html#pluginsettingtab">PluginSettingTab</a> ç±»å¯ä»¥åˆ›å»ºæ’ä»¶çš„é…ç½® tabã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å…ˆåœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹åˆ›å»º <code>settings.ts</code> æ–‡ä»¶ï¼Œç”¨äºè‡ªå®šä¹‰æ’ä»¶çš„è®¾ç½®ï¼š</p>
<pre><code class="language-ts">// settings.ts

// å¯¼å…¥æ’ä»¶
import LinkKeeper from './main'

import { App, PluginSettingTab, Setting } from 'obsidian'

// åˆ›å»ºæ’ä»¶çš„è‡ªå®šä¹‰é…ç½®
export class LinkKeeperSettingTab extends PluginSettingTab {
  plugin: LinkKeeper
  
  /**
  * æ„é€ å‡½æ•°ä¸­æ¥å—ä¸¤ä¸ªå‚æ•°
  * app: Obsidian ä¸­çš„Appå¯¹è±¡
  * plugin: éœ€è¦è‡ªå®šä¹‰è®¾ç½®çš„æ’ä»¶å¯¹è±¡
  */
  constructor (app: App, plugin: LinkKeeper) {
    super (app, plugin)
    this.plugin = plugin
  }

  display(): void {
    // containerEl æ˜¯æ’ä»¶è®¾ç½®é¢æ¿çš„å®¹å™¨
    const { containerEl } = this
    // æ¸…ç©ºé¢æ¿
    containerEl.empty()
    // æ·»åŠ æ§ä»¶åˆ°é¢æ¿å®¹å™¨ä¸­
    new Setting(containerEl)
      .setName(&quot;Link Filepath&quot;) // è®¾ç½®æ§ä»¶åç§°
      .setDesc(&quot;The file where saves the links.&quot;) // è®¾ç½®æ§ä»¶æè¿°æ–‡æ¡ˆ
      .addText((text) =&gt; // addText æ–¹æ³•ç”¨äºåˆ›å»º input æ–‡æœ¬æ¡†, å›è°ƒå‡½æ•°ä¸­çš„å‚æ•°ä¸ºæ–‡æœ¬æ¡†domå¯¹è±¡
        text
          .setPlaceholder(&quot;Enter the full filepath&quot;) // è®¾ç½®æ–‡æœ¬æ¡† placeholder
          .setValue(this.plugin.settings.filepath) // è®¾ç½®æ–‡æœ¬æ¡†å†…å®¹
          .onChange(async (value) =&gt; { // ç›‘å¬æ–‡æœ¬æ¡†çš„ change äº‹ä»¶
            this.plugin.settings.filepath = value
            await this.plugin.saveSettings() // ä¿å­˜è®¾ç½®
          })
      )
  }
}
</code></pre>
<p>åœ¨è‡ªå®šä¹‰è®¾ç½®æ—¶éœ€è¦å¼•å…¥è‡ªå®šä¹‰æ’ä»¶ï¼Œä»¥ä¾¿å°†è®¾ç½®ç»‘å®šåˆ°å¯¹åº”æ’ä»¶ä¸Šã€‚æ‰“å¼€æ’ä»¶çš„å…¥å£æ–‡ä»¶ <code>main.ts</code> ï¼Œç”±äºæ‹‰å–çš„æ’ä»¶æ¨¡æ¿ä¸­å­˜åœ¨å…¶ä»–ç¤ºä¾‹å†…å®¹ï¼Œæˆ‘ä»¬å…ˆâ€œæ¸…ç†â€ä¸€ä¸‹ <code>main.ts</code> æ–‡ä»¶ï¼Œåªä¿ç•™æˆ‘ä»¬éœ€è¦çš„å†…å®¹ï¼š</p>
<pre><code class="language-ts">// main.ts

// å¼•å…¥ Plugin ç±»
import { Plugin } from &quot;obsidian&quot;

// åˆ›å»ºè‡ªå®šä¹‰æ’ä»¶
export default class InsertLinkPlugin extends Plugin {
  async onload() {
     // onload æ–¹æ³•åœ¨æ’ä»¶è¢«å¯ç”¨æ—¶è°ƒç”¨
  }
}
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>æ³¨ï¼š</strong></p>
<p>åœ¨ Obsidian ä¸­ï¼Œè‡ªå®šä¹‰æ’ä»¶çš„ç±»ç»§æ‰¿è‡ªæ’ä»¶åŸºç±» <a href="https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh/api/classes/Plugin_2.html#plugin-2">Plugin</a>ã€‚æ’ä»¶å­˜åœ¨ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼š<strong>onload</strong> ä»¥åŠ <strong>onunload</strong>ï¼Œåˆ†åˆ«åœ¨ç»„ä»¶å¯ç”¨æ—¶ä»¥åŠç¦ç”¨æ—¶è°ƒç”¨ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ<a href="https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh/concepts/plugin-anatomy.html#%E6%8F%92%E4%BB%B6%E5%89%96%E6%9E%90">æ’ä»¶å‰–æ</a>ã€‚</p>
</blockquote>
<p>&quot;æ¸…ç†&quot;å®Œæˆåï¼Œæˆ‘ä»¬éœ€è¦åœ¨ <code>main.ts</code> ä¸­å¼•å…¥æ’ä»¶è®¾ç½®ï¼Œå¹¶åœ¨ <strong>onload</strong> é˜¶æ®µå°†è‡ªå®šä¹‰è®¾ç½®æ³¨å†Œåˆ°æ’ä»¶ä¸Šï¼š</p>
<pre><code class="language-ts">// main.ts

import { Plugin } from &quot;obsidian&quot;
// å¼•å…¥è‡ªå®šä¹‰è®¾ç½®
import { LinkKeeperSettingTab } from './settings'

// å®šä¹‰è‡ªå®šä¹‰è®¾ç½®çš„ç±»å‹
interface LinkKeeperSettings {
  filepath: string
}
// å®šä¹‰è‡ªå®šä¹‰è®¾ç½®çš„é»˜è®¤å€¼
const DEFAULT_SETTINGS: Partial&lt;LinkKeeperSettings&gt; = {
  filepath: `${process.env.HOME}/etl.json`
}

export default class LinkKeeperPlugin extends Plugin {
  settings: LinkKeeperSettings
  
  async onload() {
    // åŠ è½½è‡ªå®šä¹‰è®¾ç½®
    await this.loadSettings()
    // å°†æ’ä»¶çš„é…ç½® tab æ·»åŠ åˆ°è®¾ç½®èœå•ä¸­
    this.addSettingTab(new LinkKeeperSettingTab(this.app, this))
  }
  
  async loadSettings () {
    // å¦‚æœä¿®æ”¹äº†é…ç½®é¡¹ï¼Œå¯ä»¥è¦†ç›–é»˜è®¤é…ç½®
    this.settings = {
      ...DEFAULT_SETTINGS,
      ...await this.loadData()
    }
  }
  
  // ç”¨äºä¿å­˜è®¾ç½®ï¼Œæš´éœ²ç»™è‡ªå®šä¹‰è®¾ç½®ç±»ä¸­ä½¿ç”¨
  async saveSettings () {
    await this.saveData(this.settings)
  }
}
</code></pre>
<p>åšå®Œä¸Šè¿°æ­¥éª¤åï¼Œæ‰§è¡Œ <strong>pnpm run dev</strong>ï¼Œä¹‹åæ‰“å¼€è®¾ç½®ç•Œé¢ï¼Œå¯ç”¨è‡ªå®šä¹‰æ’ä»¶ï¼Œå³å¯åœ¨è®¾ç½®ä¸­çœ‹åˆ°æ’ä»¶çš„è‡ªå®šä¹‰é…ç½®äº†ï¼š</p>
<p align="center">
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0eba8575a67d4c1f9eea944ea70e49e4~tplv-k3u1fbpfcp-watermark.image?" />
</p>
<p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†ç¬¬ä¸€æ­¥ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ç€æ‰‹å®ç°æˆ‘ä»¬çš„åŠŸèƒ½äº†~</p>
<h2 id="æ·»åŠ é“¾æ¥">æ·»åŠ é“¾æ¥</h2>
<p>è¦æƒ³æ·»åŠ é“¾æ¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ·»åŠ é“¾æ¥çš„ç•Œé¢ã€‚æˆ‘ä»¬æ¥è®¾æƒ³ä¸‹è¿™ä¸ªç•Œé¢é‡Œéœ€è¦å®ç°å“ªäº›åŠŸèƒ½ï¼š</p>
<blockquote>
<ol>
<li>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ·»åŠ ä¸¤ä¸ªè¾“å…¥æ¡†ç”¨äºè®¾ç½®é“¾æ¥çš„åç§°ä»¥åŠåœ°å€ï¼›</li>
<li>ä¹‹åå†æ·»åŠ ä¸€ä¸ªæŒ‰é’®ï¼Œç‚¹å‡»åå¯¹è¾“å…¥çš„å†…å®¹è¿›è¡Œæ ¡éªŒå¹¶ä¿å­˜ï¼›</li>
<li>å¦‚æœé‡åˆ°å¼‚å¸¸åœºæ™¯ï¼Œæ¯”å¦‚æ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¾“å…¥å†…å®¹ä¸ºç©ºç­‰æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦ç»™å‡ºå‹å¥½çš„å¼¹çª—æç¤ºã€‚</li>
</ol>
</blockquote>
<p>å¥½ï¼ŒåŠŸèƒ½å·²ç»æ˜ç¡®äº†ï¼Œé‚£æˆ‘ä»¬å°±æ¥é€æ­¥å®ç°å®ƒä»¬ï¼Œå†²å†²å†²ï¼</p>
<h3 id="ç¬¬ä¸€æ­¥æ·»åŠ é“¾æ¥çš„ç•Œé¢">ç¬¬ä¸€æ­¥ï¼šæ·»åŠ é“¾æ¥çš„ç•Œé¢</h3>
<p>ä¸Šæ–‡ä¸­æåˆ°çš„ <strong>ç•Œé¢</strong>ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Obsidian æä¾›çš„ <a href="https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh/api/classes/Modal.html#modal">Modal</a> æ¥å®ç°ã€‚<strong>Modal</strong> ç”¨äºåˆ›å»ºä¸€ä¸ªæ¨¡æ€æ¡†ï¼Œåœ¨æ¨¡æ€æ¡†ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <a href="https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh/api/classes/Setting.html#setting">Setting</a> ä»¥åŠ <a href="https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh/guides/html-elements.html#html-elements">createEl</a> çš„æ–¹å¼æ¥è‡ªå®šä¹‰æ‰€éœ€è¦æ˜¾ç¤ºçš„è¡¨å•æ§ä»¶æˆ–è€…è‡ªå®šä¹‰å…ƒç´ å†…å®¹ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»º <code>modals.ts</code> æ–‡ä»¶ï¼Œç”¨äºåˆ›å»ºæ¨¡æ€æ¡†ï¼š</p>
<pre><code class="language-ts">// modal.ts

import { App, Modal } from &quot;obsidian&quot;

// åˆ›å»ºæ·»åŠ åœ°å€çš„æ¨¡æ€æ¡†
export class AddLink extends Modal {
  linkName: string // ç”¨äºä¿å­˜é“¾æ¥åç§°
  linkUrl: string // ç”¨äºä¿å­˜é“¾æ¥åœ°å€

  constructor(
    app: App
  ) {
    super(app)
  }
  // åœ¨æ¨¡æ€æ¡†æ‰“å¼€æ—¶è°ƒç”¨
  onOpen (): void {
  }
  // åœ¨æ¨¡æ€æ¡†å…³é—­æ—¶è°ƒç”¨
  onClose(): void {
    // éœ€è¦æ¸…ç©ºæ¨¡æ€æ¡†çš„å†…å®¹
    this.contentEl.empty()
  }
}
</code></pre>
<h3 id="ç¬¬äºŒæ­¥æ·»åŠ åç§°-åœ°å€è¾“å…¥æ¡†">ç¬¬äºŒæ­¥ï¼šæ·»åŠ åç§° &amp;&amp; åœ°å€è¾“å…¥æ¡†</h3>
<p>é€šè¿‡ Obsidian æä¾›çš„ <strong>Setting</strong> ç±»ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„åˆ›å»ºä¸¤ä¸ªç”¨äºè¾“å…¥çš„æ–‡æœ¬æ¡†ã€‚åˆ›å»ºæ–‡æœ¬æ¡†éœ€è¦ç”¨åˆ° <strong>Setting</strong> ä¸­çš„ <a href="https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh/api/classes/Setting.html#addtext">addText</a> æ–¹æ³•ã€‚</p>
<p>åœ¨ <code>onOpen</code> æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬æ’å…¥ä»¥ä¸‹ä»£ç </p>
<pre><code class="language-ts">// modal.ts

onOpen (): void {
  // contentEl æ˜¯æ¨¡æ€æ¡†çš„ Element å¯¹è±¡
  const { contentEl } = this
  // è®¾ç½®æ¨¡æ€æ¡†æ ‡é¢˜
  contentEl.createEl(&quot;h1&quot;, { text: &quot;Add Link&quot;, cls: &quot;title&quot; })
  // åˆ›å»ºç”¨äºè®¾ç½®åœ°å€åç§°çš„ input æ¡†
  new Setting(contentEl).setName(&quot;Link name&quot;).addText(text =&gt; 
    text.setValue(this.linkName).setPlaceholder('name').onChange((value) =&gt; {
      this.linkName = value
    })
  )
  // åˆ›å»ºç”¨äºè®¾ç½®åœ°å€ url çš„ input æ¡†
  new Setting(contentEl).setName(&quot;Link url&quot;).addText(text =&gt;
    text.setValue(this.linkUrl).setPlaceholder('url').onChange((value) =&gt; {
      this.linkUrl = value
    })
  )
}
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>æ³¨ï¼š</strong></p>
<p><strong>createEl</strong> æ–¹æ³•ç”¨äºè‡ªå®šä¹‰ Html æ ‡ç­¾ï¼Œå…¶ä¸­ <code>cls</code> ç”¨äºè®¾ç½®æ ‡ç­¾çš„ <code>class</code> å±æ€§ï¼Œå¯ä»¥ç”¨äºè®¾ç½®æ ‡ç­¾æ ·å¼ã€‚æ ·å¼ç»Ÿä¸€è®¾ç½®åœ¨é¡¹ç›®æ ¹ç›®å½•çš„ <code>style.css</code> æ–‡ä»¶ä¸­ã€‚</p>
</blockquote>
<h3 id="ç¬¬ä¸‰æ­¥æ·»åŠ ä¿å­˜æŒ‰é’®">ç¬¬ä¸‰æ­¥ï¼šæ·»åŠ ä¿å­˜æŒ‰é’®</h3>
<p>æ·»åŠ æŒ‰é’®éœ€è¦ç”¨åˆ° <strong>Setting</strong> ä¸­çš„ <a href="https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh/api/classes/Setting.html#addbutton">addButton</a> æ–¹æ³•ã€‚</p>
<p>åœ¨ <code>onOpen</code> æ–¹æ³•ä¸­ç»§ç»­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre><code class="language-ts">// modal.ts

onOpen (): void {
  // çœç•¥ä¸Šè¿°ä»£ç 
  
  // åˆ›å»ºä¸€ä¸ªæŒ‰é’®
  new Setting(contentEl).addButton((btn) =&gt;
    btn
      .setButtonText('Add') // è®¾ç½®æŒ‰é’®æ–‡æ¡ˆ
      .setCta()
      .onClick(() =&gt; {
        // æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶
      })
  )
}
</code></pre>
<h3 id="ç¬¬å››æ­¥å®ç°æ ¡éªŒ-ä¿å­˜åŠŸèƒ½">ç¬¬å››æ­¥ï¼šå®ç°æ ¡éªŒ &amp;&amp; ä¿å­˜åŠŸèƒ½</h3>
<p>æ¥ä¸‹æ¥ï¼Œåœ¨ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ–‡æœ¬æ¡†ä¸­çš„å†…å®¹è¿›è¡Œæ ¡éªŒï¼Œå¹¶ç»™å‡ºæç¤ºã€‚åœ¨è¿™é‡Œæˆ‘ä»¬ä»…æ ¡éªŒæ–‡æœ¬æ¡†ä¸­æ˜¯å¦è¾“å…¥å†…å®¹ï¼Œå¦‚æœæ–‡æœ¬æ¡†ä¸­çš„å†…å®¹ä¸ºç©ºï¼Œåˆ™ç»™å‡º popup æç¤ºï¼Œå¦åˆ™å°±ä¿å­˜è¾“å…¥çš„å†…å®¹ã€‚</p>
<p>Obsidian ä¸­æä¾›äº† <a href="https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh/api/classes/Notice.html#notice">Notice</a> ç±»ç”¨äºç”Ÿæˆæç¤ºã€‚ç”±äºæç¤ºçš„ popup å¯èƒ½ä¼šåœ¨å¤šå‡ºä½¿ç”¨åˆ°ï¼Œè¿™é‡Œæˆ‘ä»¬å°†å…¶æŠ½å–åˆ°å•ç‹¬çš„ <code>utils.ts</code> æ–‡ä»¶ä¸­ï¼š</p>
<pre><code class="language-ts">// utils.ts

import { Notice } from 'obsidian'

export const noticeHandler = (msg: string) =&gt; new Notice(msg) 
</code></pre>
<p>ä¹‹åï¼Œæˆ‘ä»¬åœ¨ <code>modals.ts</code> æ–‡ä»¶ä¸­å¼•å…¥ï¼Œå¹¶æ·»åŠ åˆ°æ£€éªŒåˆ¤æ–­ä¸­å»ï¼š</p>
<pre><code class="language-ts">// modal.ts

import { noticeHandler } from './utils'

// çœç•¥ä¸€å¤§æ³¢ä»£ç 

onOpen (): void {
  
  // çœç•¥ä¸€å°æ³¢ä»£ç 
  
  new Setting(contentEl).addButton((btn) =&gt;
    btn
      .setButtonText('Add') // è®¾ç½®æŒ‰é’®æ–‡æ¡ˆ
      .setCta()
      .onClick(() =&gt; {
        // åœ¨ä¸Šè¿° input çš„ onChange äº‹ä»¶ä¸­å·²ç»ä¿å­˜äº† linkName ä»¥åŠ linkUrl
        // åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è·å–è¿›è¡Œæ ¡éªŒ
        const { linkName, linkUrl } = this
        if (!(linkName.trim())) {
          noticeHandler('Link name is required!')
        } else if (!(linkUrl.trim())) {
          noticeHandler('Link url is required!')
        }
      })
  )
}
</code></pre>
<p>é€šè¿‡æ ¡éªŒåï¼Œæˆ‘ä»¬éœ€è¦å¯¹å¡«å…¥çš„å€¼è¿›è¡Œä¿å­˜ï¼Œæ‰€è°“çš„ä¿å­˜å…¶å®å°±æ˜¯å°†å€¼å†™å…¥æ–‡ä»¶ä¸­ã€‚ä¸ºäº†ä¿è¯æ¨¡æ€æ¡†æ¨¡å—çš„çº¯å‡€ï¼Œæˆ‘ä»¬å°†ä¿å­˜çš„é€»è¾‘æ”¾åœ¨ <code>main.ts</code> ä¸­å®Œæˆã€‚æ‰€ä»¥ï¼Œåœ¨ <code>main.ts</code> ä¸­è°ƒç”¨è¿™ä¸ª <strong>Modal</strong> çš„æ—¶å€™ï¼Œéœ€è¦ä¼ å…¥ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œç”¨äºä¿å­˜é“¾æ¥è®¾ç½®ã€‚åŒæ—¶ï¼Œåœ¨ <code>main.ts</code> ä¸­éœ€è¦é€šè¿‡ <a href="https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh/api/classes/Plugin_2.html#addcommand">addCommand</a> æ–¹æ³•åˆ›å»ºè‡ªå®šä¹‰æŒ‡ä»¤ï¼Œç”¨äºå‘¼èµ·æ¨¡æ€æ¡†ã€‚</p>
<p>æ‰“å¼€ <code>main.ts</code>ï¼Œæ·»åŠ ä¿å­˜åœ°å€é…ç½®çš„æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨ <code>onload</code> æ–¹æ³•ä¸­åˆ›å»ºè‡ªå®šä¹‰æŒ‡ä»¤çš„é€»è¾‘ï¼š</p>
<pre><code class="language-ts">// main.ts

import { Plugin, Editor } from &quot;obsidian&quot;
import { AddLink } from &quot;./modals&quot;
import { LinkKeeperSettingTab } from './settings'
import { readFile, writeFile } from 'fs/promises'
import { noticeHandler } from './utils'
interface LinkKeeperSettings {
  filepath: string
}

interface Options {
  [key: string]: string
}

const DEFAULT_SETTINGS: Partial&lt;LinkKeeperSettings&gt; = {
  filepath: `${process.env.HOME}/etl.json`
}

export default class LinkKeeperPlugin extends Plugin {
  settings: LinkKeeperSettings

  /**
   * get all links
   * @param cb 
   */
  async getLinks (cb: (data: Options) =&gt; void) {
    try {
      const data = await readFile(this.settings.filepath, { encoding: 'utf-8'})
      cb(JSON.parse(data || '{}'))
    } catch (err) {
      noticeHandler(err.message)
    }
  }
  
  /**
   * save link
   * @param data 
   * @param message 
   */
  async saveLink (data: Options, message: string) {
    try {
      await writeFile(this.settings.filepath, JSON.stringify(data))
      noticeHandler(message)
    } catch (err) {
      noticeHandler(err.message)
    }
  }

  /**
   * add link submission
   * @param name 
   * @param url 
   */
  onSubmit (name: string, url: string) {
    this.getLinks(async (data: Options) =&gt; {
      if (Object.prototype.toString.call(data) === '[object Object]') {
        this.saveLink({...data, [name]: url}, 'Add Link successfully!')
      } else {
        noticeHandler('Data format error! It must be a json object.')
      }
    })
  }

  /**
   * init modal
   * @param type 
   * @param options 
   * @returns 
   */
  initModal (type: string) {
    switch (type) {
      case 'addLink':
        return new AddLink(this.app, this.onSubmit.bind(this))

      default: break
    }
  }

  async onload() {
    // æ·»åŠ å‘¼èµ·æ¨¡æ€æ¡†çš„é€»è¾‘
    this.addCommand({
      id: &quot;add-link&quot;, // ç”¨äºè®¾ç½®æ¨¡æ€æ¡† id
      name: &quot;Add link&quot;, // ç”¨äºè®¾ç½®æ¨¡æ€æ¡†åç§°
      callback: () =&gt; { // æ‰§è¡Œå‘½ä»¤çš„å›è°ƒå‡½æ•°
        // æ‰“å¼€æ¨¡æ€æ¡†
        this.initModal('addLink').open()
      }
    })
  }
}
</code></pre>
<p>è¿™é‡Œæˆ‘ä»¬æ·»åŠ äº† <code>onSubmit</code> æ–¹æ³•ï¼Œæä¾›ç»™æ¨¡æ€æ¡†ä½¿ç”¨ï¼Œç”¨äºä¿å­˜åœ°å€è®¾ç½®ã€‚å›åˆ° <code>modal.ts</code> æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æŒ‰é’®çš„å›è°ƒäº‹ä»¶ä¸­åŠ å…¥ä¿å­˜åœ°å€çš„æ–¹æ³•ï¼š</p>
<pre><code class="language-ts">// modal.ts

export class AddLink extends Modal {
  linkName: string
  linkUrl: string

  onSubmit: (linkName: string, linkUrl: string) =&gt; void

  constructor(
    app: App,
    onSubmit: (linkName: string, linkUrl: string) =&gt; void
  ) {
    // çœç•¥ä¸€å°æ³¢ä»£ç 
    
    // ç»‘å®šä¼ è¿‡æ¥çš„ onSubmit æ–¹æ³•
    this.onSubmit = onSubmit
  }

  onOpen (): void {
    // çœç•¥ä¸€å°æ³¢ä»£ç 
    new Setting(contentEl).addButton((btn) =&gt;
      btn
        .setButtonText('Add')
        .setCta()
        .onClick(() =&gt; {
          const { linkName, linkUrl } = this
          if (!(linkName.trim())) {
            noticeHandler('Link name is required!')
          } else if (!(linkUrl.trim())) {
            noticeHandler('Link url is required!')
          } else {
            this.close() // æ·»åŠ å®Œæˆåï¼Œéœ€è¦å…³é—­æ¨¡æ€æ¡†
            this.onSubmit(this.linkName, this.linkUrl) // è°ƒç”¨ä¼ è¿‡æ¥çš„ onSubmit æ–¹æ³•
          }
        })
    )
  }
  
  // çœç•¥ä¸€å°æ³¢ä»£ç 
}
</code></pre>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬çš„æ¨¡æ€æ¡†åŠŸèƒ½å·²ç»å®Œæˆäº†ã€‚è¿˜è®°å¾—æˆ‘ä»¬åœ¨ <code>modal.ts</code> ä¸­æ·»åŠ çš„ç”¨äºå‘¼èµ·æ¨¡æ€æ¡†çš„è‡ªå®šä¹‰æŒ‡ä»¤ä¹ˆï¼Ÿç°åœ¨æˆ‘ä»¬å°±æ¥ç”¨å®ƒå‘¼èµ·æ·»åŠ åœ°å€çš„æ¨¡æ€æ¡†ã€‚</p>
<p>ç‚¹å‡» Obsidian ç•Œé¢å·¦ä¾§çš„å‘½ä»¤è¡Œå›¾æ ‡ï¼Œåœ¨å¼¹å‡ºçš„ç•Œé¢ä¸­æœç´¢ <code>Add link</code>ï¼ˆä¹‹å‰åœ¨ <code>addCommand</code> ä¸­è®¾ç½®çš„è‡ªå®šä¹‰æŒ‡ä»¤åç§°ï¼‰:</p>
<p align="center">
<img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/37b2b6e620c04e848558b48d37345d52~tplv-k3u1fbpfcp-watermark.image?" />
</p>
<p>é€‰æ‹©è“æ¡†ä¸­çš„å‘½ä»¤åï¼Œå°±ä¼šå¼¹å‡ºæ·»åŠ åœ°å€çš„æ¨¡æ€æ¡†äº†ï¼š</p>
<p align="center">
<img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e3eb8f27f79c4410abae5afcac274eb3~tplv-k3u1fbpfcp-watermark.image?" />
</p>
<p>ç›´æ¥ç‚¹å‡»æ·»åŠ æŒ‰é’®ï¼Œä¹Ÿä¼šåœ¨å³ä¸Šè§’çœ‹åˆ°æç¤ºä¿¡æ¯ã€‚</p>
<h2 id="åˆ é™¤é“¾æ¥">åˆ é™¤é“¾æ¥</h2>
<p>è€è§„çŸ©ï¼Œæˆ‘ä»¬è¿˜æ˜¯å…ˆæ¥è®¾æƒ³ä¸‹ç”¨äºåˆ é™¤çš„æ¨¡æ€æ¡†éœ€è¦å®ç°å“ªäº›åŠŸèƒ½ï¼š</p>
<blockquote>
<ol>
<li>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€ä¸ªä¸‹æ‹‰æ¡†ï¼Œç”¨äºé€‰æ‹©éœ€è¦åˆ é™¤çš„åœ°å€ï¼›</li>
<li>ä¹‹åå†æ·»åŠ ä¸€ä¸ªæŒ‰é’®ï¼Œç‚¹å‡»ååˆ é™¤æ‰€é€‰çš„åœ°å€ï¼›</li>
<li>å¦‚æœé‡åˆ°å¼‚å¸¸åœºæ™¯æˆ‘ä»¬éœ€è¦ç»™å‡ºå‹å¥½çš„å¼¹çª—æç¤ºã€‚</li>
</ol>
</blockquote>
<p>æœ‰äº†æ·»åŠ é“¾æ¥çš„ç»éªŒï¼Œåˆ›å»ºåˆ é™¤é“¾æ¥çš„æ¨¡æ€æ¡†å°±å®¹æ˜“å¤šäº†ã€‚åœ¨åˆ é™¤é“¾æ¥çš„æ¨¡æ€æ¡†ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ <strong>Setting</strong> ä¸­æä¾›çš„ <a href="">addDropdown</a> æ–¹æ³•æ·»åŠ ä¸€ä¸ªä¸‹æ‹‰æ¡†ï¼Œç”¨äºé€‰æ‹©éœ€è¦åˆ é™¤çš„åœ°å€ã€‚æ­¤å¤„ç›´æ¥ä¸Šä»£ç ï¼š</p>
<pre><code class="language-ts">export class DeleteLink extends Modal {
  linkName: string
  options: Options

  onDelete: (linkName: string) =&gt; void

  constructor (
    app: App,
    options: Options, // ç”¨æ¥æ¥æ”¶ä¸‹æ‹‰é¡¹
    onDelete: (linkName: string) =&gt; void // åˆ é™¤äº‹ä»¶
  ) {
    super(app)
    this.onDelete = onDelete
    this.options = options
    this.linkName = Object.keys(options)[0] || '' // é»˜è®¤åˆ é™¤ç¬¬ä¸€ä¸ª
  }

  onOpen (): void {
    const { contentEl } = this

    contentEl.createEl(&quot;h1&quot;, { text: &quot;Delete Link&quot;, cls: &quot;title&quot; })
    
    // åˆ›å»ºä¸‹æ‹‰æ¡†
    new Setting(contentEl).setName(&quot;Link name&quot;).addDropdown(dp =&gt; 
      dp.addOptions(this.options).onChange(value =&gt; {
        this.linkName = value
      })
    )
    // åˆ›å»ºåˆ é™¤æŒ‰é’®
    new Setting(contentEl).addButton((btn) =&gt;
      btn
        .setButtonText('Delete')
        .setCta()
        .onClick(() =&gt; {
          const { linkName } = this
          if (!linkName) {
            noticeHandler('Link name is required!')
          } else {
            this.close()
            this.onDelete(this.linkName)
          }
        })
    )
  }

  onClose(): void {
    this.contentEl.empty()
  }
}
</code></pre>
<p>ä¹‹åå›åˆ° <code>main.ts</code> æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦åŠ å…¥ <strong>åˆ é™¤æ¨¡æ€æ¡†çš„è°ƒå‡ºæŒ‡ä»¤ã€è·å–åˆ é™¤ä¸‹æ‹‰é€‰é¡¹çš„ options ä»¥åŠæ·»åŠ åˆ é™¤æ–¹æ³•</strong>ï¼š</p>
<pre><code class="language-ts">// main.ts

import { Plugin, Editor } from &quot;obsidian&quot;
import { AddLink, DeleteLink } from &quot;./modals&quot;
import { LinkKeeperSettingTab } from './settings'
import { readFile, writeFile } from 'fs/promises'
import { noticeHandler } from './utils'
interface LinkKeeperSettings {
  filepath: string
}

interface Options {
  [key: string]: string
}

const DEFAULT_SETTINGS: Partial&lt;LinkKeeperSettings&gt; = {
  filepath: `${process.env.HOME}/etl.json`
}

export default class LinkKeeperPlugin extends Plugin {
  settings: LinkKeeperSettings

  /**
   * get all links
   * @param cb 
   */
  async getLinks (cb: (data: Options) =&gt; void) {
    try {
      const data = await readFile(this.settings.filepath, { encoding: 'utf-8'})
      cb(JSON.parse(data || '{}'))
    } catch (err) {
      noticeHandler(err.message)
    }
  }
  
  /**
   * delete link by name
   * @param name 
   */
  async onDelete (name: string) {
    await this.getLinks(async (data: Options) =&gt; {
      delete data[name]
      this.saveLink(data, `Link named ${name} has been deleted!`)
    })
  }

  /**
   * init modal
   * @param type 
   * @param options 
   * @returns 
   */
  initModal (type: string, options?: Options) {
    switch (type) {
      // çœç•¥ä¸€å°æ³¢ä»£ç 
      
      // åˆ›å»ºåˆ é™¤åœ°å€çš„æ¨¡æ€æ¡†
      case 'deleteLink':
        return new DeleteLink(this.app, options, this.onDelete.bind(this))

      default: break
    }
  }

  async onload() {
    // çœç•¥ä¸€å°æ³¢ä»£ç 
    
    // æ–°å¢å‘¼å‡ºåˆ é™¤æ¨¡æ€æ¡†çš„è‡ªå®šä¹‰æŒ‡ä»¤
    this.addCommand({
      id: &quot;delete-link&quot;,
      name: 'Delete link',
      callback: () =&gt; {
        this.getLinks(async (data: Options) =&gt; {
          // åˆ›å»ºåˆ é™¤çš„æ¨¡æ€æ¡†ï¼Œå¹¶ä¼ å…¥ options
          this.initModal('deleteLink', Object.keys(data).reduce((obj, key) =&gt; ({
            ...obj,
            [key]: key
          }), {})).open()
        })
      }
    })
  }

  // çœç•¥ä¸€å°æ³¢ä»£ç 
}
</code></pre>
<p>ä¹‹åï¼Œç‚¹å‡» Obsidian ç•Œé¢å·¦ä¾§çš„å‘½ä»¤è¡Œå›¾æ ‡ï¼Œåœ¨å¼¹å‡ºçš„ç•Œé¢ä¸­æœç´¢ <code>Delete link</code> å¹¶ç‚¹å‡»ï¼Œå°±å¯ä»¥çœ‹åˆ°åˆ é™¤åœ°å€çš„æ¨¡æ€å¼¹æ¡†å•¦ï¼š</p>
<p align="center">
<img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/92cb761ff8d143848c0d345c6437ef29~tplv-k3u1fbpfcp-watermark.image?" />
</p>
<h2 id="æŸ¥çœ‹-è·³è½¬é“¾æ¥">æŸ¥çœ‹ &amp;&amp; è·³è½¬é“¾æ¥</h2>
<p>åœ¨è¿™ä¸ªæ¨¡æ€æ¡†ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æä¾›ä»¥ä¸‹å‡ ç§åŠŸèƒ½ï¼š</p>
<blockquote>
<ol>
<li>æä¾›ä¸€ä¸ªå¯ä»¥æŒ‰ç…§åœ°å€åç§°è¿›è¡Œç­›é€‰çš„æœç´¢æ¡†ï¼›</li>
<li>åˆ—å‡ºå·²ç»ä¿å­˜çš„åœ°å€ï¼Œæ˜¾ç¤ºå¯¹åº”çš„åç§°ä»¥åŠè·³è½¬åœ°å€ï¼Œå¹¶ä¸”ç»™åœ°å€åŠ ä¸Šé“¾æ¥ï¼Œä»¥ä¾¿ç›´æ¥ç‚¹å‡»è·³è½¬</li>
</ol>
</blockquote>
<p>å›åˆ° <code>modals.ts</code> ï¼Œæˆ‘ä»¬å…ˆåˆ›å»ºç”¨äºç½—åˆ—åœ°å€çš„æ¨¡æ€æ¡†ï¼š</p>
<pre><code class="language-ts">// modal.ts

export class ListAllLinks extends Modal {
  options: Options

  constructor (
    app: App,
    options: Options // ç”¨äºæ¥æ”¶åœ°å€é…ç½®
  ) {
    super(app)
    this.options = options
  }

  onOpen(): void {
    const { contentEl } = this
    // åˆ›å»ºæ ‡é¢˜
    contentEl.createEl(&quot;h1&quot;, { text: &quot;All Links&quot;, cls: &quot;title&quot; })
  }

  onClose(): void {
    this.contentEl.empty()
  }
}
</code></pre>
<h3 id="æ·»åŠ æœç´¢æ¡†">æ·»åŠ æœç´¢æ¡†</h3>
<p>è¿™é‡Œè¦ç”¨åˆ° <strong>Setting</strong> ä¸­æä¾›çš„ <a href="https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh/api/classes/Setting.html#addsearch">addSearch</a> æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªæœç´¢æ¡†ï¼š</p>
<pre><code class="language-ts">// modal.ts

// çœç•¥ä¸€å°æ³¢ä»£ç 

onOpen(): void {
    const { contentEl } = this

    contentEl.createEl(&quot;h1&quot;, { text: &quot;All Links&quot;, cls: &quot;title&quot; })
    // åˆ›å»ºæœç´¢æ¡†
    new Setting(contentEl).setName('Search').addSearch(el =&gt; {
      el.setPlaceholder('Input the link name...').onChange(val =&gt; {
        // ç›‘å¬æœç´¢æ¡†çš„ change äº‹ä»¶ï¼Œåœ¨æœç´¢æ¡†å†…å®¹å‘ç”Ÿå˜åŒ–æ—¶é‡æ–°æ¸²æŸ“åˆ—è¡¨
      })
    })
}
</code></pre>
<h3 id="æ·»åŠ åœ°å€åˆ—è¡¨">æ·»åŠ åœ°å€åˆ—è¡¨</h3>
<p>åœ¨ä¸Šè¿°è¿‡ç¨‹ä¸­ä¸€ç›´æœ‰ä½¿ç”¨çš„ <strong>Setting</strong> ç±»ä¸»è¦æ˜¯ç”¨æ¥åˆ›å»ºè¡¨å•æ§ä»¶çš„ï¼Œè€Œåˆ—è¡¨å†…å®¹ä¸»è¦ç”±è‡ªå®šä¹‰æ ‡ç­¾æ„æˆï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <a href="https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh/guides/html-elements.html#create-html-elements-using-createel">createEl</a> æ–¹æ³•ã€‚ç”±äºåœ¨æ¨¡æ€æ¡†åˆå§‹åŒ–é˜¶æ®µä»¥åŠæœç´¢æ¡†å†…å®¹å˜åŒ–é˜¶æ®µéƒ½éœ€è¦æ¸²æŸ“åˆ—è¡¨ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°†åˆ—è¡¨æ¸²æŸ“çš„é€»è¾‘æŠ½å–å‡ºæ¥ã€‚</p>
<pre><code class="language-ts">// modal.ts

export class ListAllLinks extends Modal {
  options: Options

  constructor (
    app: App,
    options: Options
  ) {
    super(app)
    this.options = options
  }
  
  /**
   * create list item
   * @param container list container
   * @param key link name
   * @param value link url
   * @param isLink determine whether it is a link
   */
  createListItem (container: Element, key: string, value: string, isLink = true) {
    // å‘ list å®¹å™¨ä¸­æ·»åŠ åœ°å€é¡¹
    const box = container.createEl(&quot;div&quot;, { cls: `list-item ${!isLink ? 'list-item-header' : ''}`})
    // æ·»åŠ æ˜¾ç¤ºåœ°å€åç§°çš„å®¹å™¨
    box.createEl(&quot;div&quot;, { text: key })
    // æ·»åŠ æ˜¾ç¤º url çš„å®¹å™¨
    const linkBox = box.createEl(&quot;div&quot;)
    // åˆ¤æ–­æ˜¯å¦æ˜¯é“¾æ¥
    if (isLink) {
      // æ˜¯é“¾æ¥çš„è¯æ·»åŠ  a æ ‡ç­¾ç”¨äºè·³è½¬
      linkBox.createEl('a', { text: value, href: value})
    } else {
      // å¦åˆ™ç›´æ¥æ˜¾ç¤ºå†…å®¹
      linkBox.createSpan({ text: value })
    }
  }
  
  // æ¸²æŸ“åˆ—è¡¨
  renderList (key = ''): Element {
    // è·å–æ‰€æœ‰åœ°å€ä¿¡æ¯
    let options = this.options
    // æ ¹æ®ä¼ è¿‡æ¥çš„ key ç­›é€‰éœ€è¦æ˜¾ç¤ºçš„åœ°å€å†…å®¹
    if (key) {
      options = Object.keys(options).reduce((obj: Options, item) =&gt; {
        if (item.includes(key)) obj = { ...obj, [item]: options[item] }
        return obj
      }, {})
    }
    // åˆ›å»ºæ˜¾ç¤ºåˆ—è¡¨çš„å†…å®¹å®¹å™¨
    const container = this.contentEl.createEl(&quot;div&quot;)
    // æ·»åŠ è¡¨å¤´ä¿¡æ¯
    this.createListItem(container, 'Name', 'Url', false)
    // åˆ›å»º list å®¹å™¨
    const listContainer = container.createEl('div', { cls: 'list-container'})
    const keys = Object.keys(options)
    // éå†æ˜¾ç¤ºåˆ—è¡¨
    if (keys.length) {
      keys.forEach(key =&gt; {
        this.createListItem(listContainer, key, options[key])
      })
    } else {
      // å½“æ²¡æœ‰æœç´¢åˆ°ç›¸åº”ç»“æœæ—¶ï¼Œæ˜¾ç¤ºæç¤ºä¿¡æ¯
      listContainer.createEl('div', { text: 'No results!', cls: 'list-empty' })
    }

    return container
  }

  onOpen(): void {
    const { contentEl } = this

    contentEl.createEl(&quot;h1&quot;, { text: &quot;All Links&quot;, cls: &quot;title&quot; })

    let contentBox: Element = null

    new Setting(contentEl).setName('Search').addSearch(el =&gt; {
      el.setPlaceholder('Input the link name...').onChange(val =&gt; {
        // å½“æœç´¢å†…å®¹å˜åŒ–æ—¶ï¼Œæ¸…ç©ºåˆ—è¡¨
        contentBox.empty()
        // é‡æ–°æ¸²æŸ“åˆ—è¡¨
        contentBox = this.renderList(val)
      })
    })
    // é¦–æ¬¡åŠ è½½æ—¶æ¸²æŸ“åˆ—è¡¨
    contentBox = this.renderList()
  }

  onClose(): void {
    this.contentEl.empty()
  }
}
</code></pre>
<p>ä¹‹åï¼Œæˆ‘ä»¬è¦å°†åˆ—è¡¨çš„æ ·å¼å†™å…¥ <code>style.css</code> æ–‡ä»¶ä¸­ï¼š</p>
<pre><code class="language-css">// style.css
/* Sets all the text color to red! */
.title {
  text-align: center;
  font-size: 20px;
}

.list-container {
  max-height: 300px;
  overflow-y: scroll;
}

.list-item-header {
  font-size: 18px;
  font-weight: bold;
}

.list-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.list-item div {
  flex: 1;
}

.list-item:not(.list-item-header) div:first-child {
  color: #222;
  font-weight: bold;
}

.list-item div:last-child {
  text-align: right;
}

.list-item:not(.list-item-header) {
  background-color: #c0c0c0;
  padding: 8px;
  border-radius: 4px;
}

.list-empty {
  text-align: center;
  font-size: 16px;
}

</code></pre>
<p>æœ€åï¼Œæˆ‘ä»¬éœ€è¦åœ¨ <code>main.ts</code> æ–‡ä»¶ä¸­æ·»åŠ å‘¼èµ·æ˜¾ç¤ºåˆ—è¡¨çš„è‡ªå®šä¹‰æŒ‡ä»¤ï¼Œå¹¶å°†åœ°å€ä¿¡æ¯ä¼ ç»™æ¨¡æ€æ¡†ï¼š</p>
<pre><code class="language-ts">// main.ts

import { Plugin, Editor } from &quot;obsidian&quot;
import { AddLink, DeleteLink, ListAllLinks } from &quot;./modals&quot;
import { LinkKeeperSettingTab } from './settings'
import { readFile, writeFile } from 'fs/promises'
import { noticeHandler } from './utils'
interface LinkKeeperSettings {
  filepath: string
}

interface Options {
  [key: string]: string
}

const DEFAULT_SETTINGS: Partial&lt;LinkKeeperSettings&gt; = {
  filepath: `${process.env.HOME}/etl.json`
}

export default class LinkKeeperPlugin extends Plugin {
  settings: LinkKeeperSettings

  /**
   * get all links
   * @param cb 
   */
  async getLinks (cb: (data: Options) =&gt; void) {
    try {
      const data = await readFile(this.settings.filepath, { encoding: 'utf-8'})
      cb(JSON.parse(data || '{}'))
    } catch (err) {
      noticeHandler(err.message)
    }
  }
  
  // çœç•¥ä¸€å°æ³¢ä»£ç 
  
  /**
   * init modal
   * @param type 
   * @param options 
   * @returns 
   */
  initModal (type: string, options?: Options) {
    switch (type) {
      // çœç•¥ä¸€å°æ³¢ä»£ç 
      
      case 'listLink':
        return new ListAllLinks(this.app, options)

      default: break
    }
  }

  async onload() {
    // çœç•¥ä¸€å°æ³¢ä»£ç 
    
    // æ·»åŠ å‘¼èµ·æ˜¾ç¤ºåœ°å€åˆ—è¡¨æ¨¡æ€æ¡†çš„æŒ‡ä»¤
    this.addCommand({
      id: 'list-links',
      name: 'List links',
      icon: 'link',
      callback: () =&gt; {
        this.getLinks(async (data: Options) =&gt; {
          this.initModal('listLink', data).open()
        })
      }
    })
  }
  
  // çœç•¥ä¸€å°æ³¢ä»£ç 
}
</code></pre>
<p>ä¹‹åï¼Œç‚¹å‡» Obsidian ç•Œé¢å·¦ä¾§çš„å‘½ä»¤è¡Œå›¾æ ‡ï¼Œåœ¨å¼¹å‡ºçš„ç•Œé¢ä¸­æœç´¢ <code>List link</code> å¹¶ç‚¹å‡»ï¼Œå°±å¯ä»¥çœ‹åˆ°åœ°å€åˆ—è¡¨çš„æ¨¡æ€å¼¹æ¡†å•¦~åœ¨æœç´¢æ¡†ä¸­è¾“å…¥å†…å®¹ï¼Œå¯ä»¥çœ‹åˆ°ç›¸åº”çš„æœç´¢ç»“æœï¼Œå¦‚æœæ²¡æœ‰ç¬¦åˆæœç´¢å†…å®¹çš„åœ°å€ä¿¡æ¯ï¼Œåˆ™ä¼šæ˜¾ç¤ºæç¤ºä¿¡æ¯ï¼š</p>
<p align="center">
<img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3b112c98bf394ec1b3f6134f16af0f78~tplv-k3u1fbpfcp-watermark.image?" />
</p>
<p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬çš„æ’ä»¶å°±åŸºæœ¬å¼€å‘å®Œæˆå•¦~~</p>
<h1 id="æ’ä»¶ä¼˜åŒ–">æ’ä»¶ä¼˜åŒ–</h1>
<h2 id="hotkeys">Hotkeys</h2>
<p>åœ¨ä¸Šè¿°è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éƒ½æ˜¯é€šè¿‡è‡ªå®šä¹‰æŒ‡ä»¤çš„æ–¹å¼æ¥å‘¼èµ·æ¨¡æ€æ¡†ï¼Œè™½ç„¶è¿‡ç¨‹å¹¶ä¸å¤æ‚ï¼Œä½†å¤šå°‘è¿˜æ˜¯æœ‰äº›ç¹çã€‚Obsidian ç»™æ’ä»¶çš„è‡ªå®šä¹‰æŒ‡ä»¤æä¾›äº†è®¾ç½®çƒ­é”®çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®è‡ªå®šä¹‰æŒ‡ä»¤çš„çƒ­é”®æ¥ç®€åŒ–è¿™ä¸ªè¿‡ç¨‹ï¼š</p>
<p align="center">
<img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/67c6ab5528714e5790c21de10d93e417~tplv-k3u1fbpfcp-watermark.image?" />
</p>
<h2 id="æ·»åŠ é€‰ä¸­çš„åœ°å€">æ·»åŠ é€‰ä¸­çš„åœ°å€</h2>
<p>å¦‚æœåœ¨ä½¿ç”¨ Obsidian çš„è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°æƒ³è¦ä¿å­˜æ–‡æ¡£ä¸­æŸä¸ªåœ°å€çš„æƒ…å†µï¼Œå¦‚æœè¦å…ˆå¤åˆ¶åœ°å€ï¼Œç„¶åå†ç²˜è´´åˆ°æ¨¡æ€æ¡†ä¸­å»ä¿å­˜ï¼Œæ„Ÿè§‰å¤šå°‘æœ‰äº›éº»çƒ¦ã€‚é‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å¯ä»¥é€‰ä¸­æƒ³è¦æ·»åŠ çš„åœ°å€ç›´æ¥è¿›è¡Œæ·»åŠ å‘¢ï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼ï¼</p>
<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <strong>addCommand</strong> æ–¹æ³•ä¸­çš„ <a href="https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh/api/interfaces/Command.html#editorcallback">editorCallback</a> äº‹ä»¶ä¸­è·å–åˆ°å½“å‰ç¼–è¾‘å™¨çš„ <code>editor</code> å¯¹è±¡ï¼Œå¹¶å€Ÿæ­¤è·å–åˆ°é€‰ä¸­çš„åœ°å€ï¼Œä¹‹åè‡ªåŠ¨å¡«å…¥æ¨¡æ€æ¡†ä¸­ã€‚ç¾æ»‹æ»‹~</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å…ˆå‰æ·»åŠ çš„ <code>Add link</code> è‡ªå®šä¹‰æŒ‡ä»¤ä»¥åŠæ·»åŠ åœ°å€çš„æ¨¡æ€æ¡†é€»è¾‘åšäº›ä¿®æ”¹ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å°† <code>callback</code> æ–¹æ³•æ”¹ä¸º <code>editorCallback</code> æ–¹æ³•ï¼Œå¹¶å°†é€‰ä¸­çš„å†…å®¹ä¼ ç»™æ¨¡æ€æ¡†ï¼š</p>
<pre><code class="language-ts">// main.ts

// çœç•¥ä¸€å¤§æ³¢ä»£ç 

initModal (type: string, options?: Options) {
  switch (type) {
    case 'addLink':
      return new AddLink(this.app, options.link, this.onSubmit.bind(this))
    // çœç•¥ä¸€å°æ³¢ä»£ç   
    default: break
  }
}

async onload() {
  // çœç•¥ä¸€å°æ³¢ä»£ç 
  this.addCommand({
    id: &quot;add-link&quot;,
    name: &quot;Add link&quot;,
    editorCallback: (editor: Editor) =&gt; {
      // è·å–é€‰ä¸­çš„åœ°å€
      const selection = editor.getSelection()
      this.initModal('addLink', { link: selection }).open()
    }
  })
}
</code></pre>
<p>ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹æ·»åŠ åœ°å€çš„æ¨¡æ€æ¡†ä»£ç ï¼Œæ¥å—ä¼ å…¥çš„åœ°å€ï¼Œå¹¶å°†å…¶ä½œä¸ºé»˜è®¤å€¼è®¾ç½®åˆ°é“¾æ¥åœ°å€çš„æ–‡æœ¬æ¡†ä¸­ï¼š</p>
<pre><code class="language-ts">// modals.ts

export class AddLink extends Modal {
  linkName: string
  linkUrl: string

  onSubmit: (linkName: string, linkUrl: string) =&gt; void

  constructor(
    app: App,
    linkUrl: string, // æ¥å—ä¼ å…¥çš„åœ°å€ä¿¡æ¯
    onSubmit: (linkName: string, linkUrl: string) =&gt; void
  ) {
    super(app)
    this.linkName = ''
    this.linkUrl = linkUrl // å°†ä¼ å…¥çš„åœ°å€ä¿¡æ¯è®¾ç½®ä¸ºé»˜è®¤å€¼
    this.onSubmit = onSubmit
  }
  
  // çœç•¥ä¸€å¤§æ³¢ä»£ç 
}
</code></pre>
<p>æ”¹é€ å®Œæˆåï¼Œæ­¤æ—¶æˆ‘ä»¬é€‰ä¸­æƒ³è¦æ·»åŠ çš„é“¾æ¥åœ°å€ï¼Œç„¶åé€šè¿‡ <strong>çƒ­é”®</strong> çš„æ–¹å¼å‘¼èµ·æ¨¡æ€æ¡†ï¼Œå³å¯çœ‹åˆ°åœ°å€å·²ç»è¢«å¡«å…¥å…¶ä¸­ï¼š</p>
<p align="center">
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e4891cd74fd64787887104770ddd315a~tplv-k3u1fbpfcp-watermark.image?" />
</p>
<h1 id="å†™åœ¨æœ€å">å†™åœ¨æœ€å</h1>
<p>è¡Œæ–‡è‡³æ­¤ï¼Œlink-keeper æ’ä»¶å°±å·²ç»å®Œæˆå•¦~æœ‰å…´è¶£çš„å°ä¼™ä¼´å¯ä»¥<a href="https://github.com/luhaifeng666/obsidian-link-keeper">ä¸‹è½½</a>ä½¿ç”¨ã€‚å¦‚æœè§‰å¾—æ’ä»¶è¿˜å¯çš„å°ä¼™ä¼´ä»¬æ¬¢è¿  star ~</p>
<p>å¦å¤–ï¼Œç¬”è€…æœ€è¿‘åœ¨ç¿»è¯‘ Obsidian çš„<a href="https://github.com/luhaifeng666/obsidian-plugin-docs-zh">æ’ä»¶å¼€å‘æ–‡æ¡£</a>ï¼Œæœ‰å…´è¶£çš„å°ä¼™ä¼´å¯ä»¥åŠ å…¥æˆ‘~ ç”±äºæœ¬äººæ°´å¹³æœ‰é™ï¼Œå¦‚æœæœ‰ç¿»è¯‘ä¸åˆ°ä½ä¹‹å¤„ä¹Ÿæ¬¢è¿å¤§ä½¬ä»¬æ issueï¼Œä»¥ä¾¿æˆ‘åŠæ—¶æ›´æ­£ã€‚</p>
<p align="center">
<img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1b8c4600b4ca4e35bcebd0dd8bba4505~tplv-k3u1fbpfcp-watermark.image?" />
</p>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://luhaifeng666.github.io/tag/4epuVB5QI/" class="tag">
                    å¼€å‘å·¥å…·
                  </a>
                
              </div>
            
            <div id="vcomments"></div>
            <span id="comment-count"></span>
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://luhaifeng666.github.io/post/tauri-chu-ti-yan/">
                  <h3 class="post-title">
                    Tauri åˆä½“éªŒ 
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>
    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>





  </body>
  <script type="text/javascript">
    // è®¾ç½®valine
    new Valine({
      av: AV,
      el: '#vcomments',
      count_el: '#comment-count',
      appId: 'HlwrEhBsDstpVpKVMUMqyfBV-9Nh9j0Va',
      appKey: 'Cs2jEIpcC6nXJFH8LsEak9Kh',
      placeholder: 'ä½ è¯´ï¼Œæˆ‘åœ¨å¬',
      visitor: true,
      // è®¾ç½®Bilibiliè¡¨æƒ…åŒ…åœ°å€
      emojiCDN: '//i0.hdslb.com/bfs/emote/',
      // è¡¨æƒ…titleå’Œå›¾ç‰‡æ˜ å°„
      emojiMaps: {
        "tv_doge": "6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png",
        "tv_äº²äº²": "a8111ad55953ef5e3be3327ef94eb4a39d535d06.png",
        "tv_å·ç¬‘": "bb690d4107620f1c15cff29509db529a73aee261.png",
        "tv_å†è§": "180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png",
        "tv_å†·æ¼ ": "b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png",
        "tv_å‘æ€’": "34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png",
        "tv_å‘è´¢": "34db290afd2963723c6eb3c4560667db7253a21a.png",
        "tv_å¯çˆ±": "9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png",
        "tv_åè¡€": "09dd16a7aa59b77baa1155d47484409624470c77.png",
        "tv_å‘†": "fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png",
        "tv_å‘•å": "9f996894a39e282ccf5e66856af49483f81870f3.png",
        "tv_å›°": "241ee304e44c0af029adceb294399391e4737ef2.png",
        "tv_åç¬‘": "1f0b87f731a671079842116e0991c91c2c88645a.png",
        "tv_å¤§ä½¬": "093c1e2c490161aca397afc45573c877cdead616.png",
        "tv_å¤§å“­": "23269aeb35f99daee28dda129676f6e9ea87934f.png",
        "tv_å§”å±ˆ": "d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png",
        "tv_å®³ç¾": "a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png",
        "tv_å°´å°¬": "7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png",
        "tv_å¾®ç¬‘": "70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png",
        "tv_æ€è€ƒ": "90cf159733e558137ed20aa04d09964436f618a1.png",
        "tv_æƒŠå“": "0d15c7e2ee58e935adc6a7193ee042388adc22af.png"
      }
    })
  </script>
</html>
