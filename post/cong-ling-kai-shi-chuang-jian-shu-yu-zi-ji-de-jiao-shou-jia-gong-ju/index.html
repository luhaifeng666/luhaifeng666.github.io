<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>ä»é›¶å¼€å§‹åˆ›å»ºå±äºè‡ªå·±çš„è„šæ‰‹æ¶å·¥å…· | é…±è±†è…ç²¾çš„å°ç«™</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://luhaifeng666.github.io/favicon.ico?v=1640407109030">
<link rel="stylesheet" href="https://luhaifeng666.github.io/styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="èƒŒæ™¯
å‰æ®µæ—¶é—´æ¥åˆ°ä¸ªéœ€æ±‚ï¼Œéœ€è¦å¼€å‘ä¸€ä¸ªä¸šåŠ¡ç»„ä»¶çš„åŒ…æä¾›ç»™ä¸šåŠ¡ç»„çš„å°ä¼™ä¼´ä»¬å»ç”¨ã€‚åœ¨æ­¤ä¹‹å‰ä¹Ÿå¼€å‘è¿‡ç±»ä¼¼çš„åŒ…ï¼Œé™¤å´åŒ…çš„ä½œç”¨ä¸åŒä¹‹å¤–ï¼Œæœ‰äº›å†…å®¹åŸºæœ¬æ˜¯å¤§å·®ä¸å·®çš„ã€‚æ¯”å¦‚git commitçš„è§„èŒƒï¼Œä¸€äº›å¿…å¤‡çš„è¯¸å¦‚ src/index.js çš„æ–‡ä»¶ç­‰ç­‰ã€‚
..." />
    <meta name="keywords" content="" />
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script>
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://luhaifeng666.github.io">
        <img src="https://luhaifeng666.github.io/images/avatar.png?v=1640407109030" class="site-logo">
        <h1 class="site-title">é…±è±†è…ç²¾çš„å°ç«™</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      æˆ‘å¹ï¼Œä½ å¬
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/luhaifeng666" target="_blank">é…±è±†è…ç²¾</a> | <a class="rss" href="https://luhaifeng666.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">ä»é›¶å¼€å§‹åˆ›å»ºå±äºè‡ªå·±çš„è„šæ‰‹æ¶å·¥å…·</h2>
            <div class="post-date">2021-12-24</div>
            
              <div class="feature-container" style="background-image: url('https://luhaifeng666.github.io/post-images/cong-ling-kai-shi-chuang-jian-shu-yu-zi-ji-de-jiao-shou-jia-gong-ju.webp')">
              </div>
            
            <div class="post-content" v-pre>
              <h1 id="èƒŒæ™¯">èƒŒæ™¯</h1>
<p>å‰æ®µæ—¶é—´æ¥åˆ°ä¸ªéœ€æ±‚ï¼Œéœ€è¦å¼€å‘ä¸€ä¸ªä¸šåŠ¡ç»„ä»¶çš„åŒ…æä¾›ç»™ä¸šåŠ¡ç»„çš„å°ä¼™ä¼´ä»¬å»ç”¨ã€‚åœ¨æ­¤ä¹‹å‰ä¹Ÿå¼€å‘è¿‡ç±»ä¼¼çš„åŒ…ï¼Œé™¤å´åŒ…çš„ä½œç”¨ä¸åŒä¹‹å¤–ï¼Œæœ‰äº›å†…å®¹åŸºæœ¬æ˜¯å¤§å·®ä¸å·®çš„ã€‚æ¯”å¦‚git commitçš„è§„èŒƒï¼Œä¸€äº›å¿…å¤‡çš„è¯¸å¦‚ <code>src/index.js</code> çš„æ–‡ä»¶ç­‰ç­‰ã€‚</p>
<p>å¦‚æœè¦æ–°å»ºä¸€ä¸ªåŒ…çš„å·¥ç¨‹ï¼Œè¯¸å¦‚ä¸Šè¿°æ‰€è¯´çš„æ–‡ä»¶å¤§å¤šä¼šå»æ—¢æœ‰çš„å·¥ç¨‹ä¸­æ‹·è´ä¸€ä»½è¿‡æ¥ä¿®ä¿®æ”¹æ”¹ï¼Œç»§è€Œå†æ¬¡åŸºç¡€ä¸Šå®Œæˆæ¥ä¸‹æ¥çš„å¼€å‘ã€‚ç­‰åˆ°ä¸‹ä¸€æ¬¡æœ‰æ–°çš„ç±»ä¼¼éœ€æ±‚æ¥çš„æ—¶å€™ï¼Œå‘¨è€Œå¤å§‹ã€‚ã€‚ã€‚Orz</p>
<p>é‚£æ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä¸ºå•¥ä¸å»æä¸€ä¸ªè„šæ‰‹æ¶å·¥å…·å»æŠŠè¿™äº›äººå·¥æ“ä½œçš„äº‹æƒ…è‡ªåŠ¨åŒ–æ‰å‘¢~</p>
<pre><code class="language-js">å¸¸è¨€é“ï¼šä¸´æ¸Šç¾¡é±¼ï¼Œä¸å¦‚...é€€å›å»è‡ªå·±ç»‡ä¸ªç½‘ï¼Œå¹²ï¼
</code></pre>
<h1 id="å‡†å¤‡å·¥ä½œ">å‡†å¤‡å·¥ä½œ</h1>
<p>ç®€å•ä¸‰æ­¥åšå¥½å‡†å¤‡å·¥ä½œ~</p>
<pre><code>ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œä¸€ä¸ªnpmçš„è´¦å·ï¼Œç”¨äºåé¢å‘åŒ…

ç¬¬äºŒæ­¥ï¼šmkdir cli-tool &amp;&amp; cd cli-tool &amp;&amp; npm init -y

ç¬¬ä¸‰æ­¥ï¼šä¹‹ååœ¨ `package.json` æ–‡ä»¶ä¸­å¡«å…¥ä¸€äº›åŸºæœ¬çš„ä¿¡æ¯å³å¯
</code></pre>
<pre><code class="language-json">{
  &quot;name&quot;: &quot;cli-tool&quot;,
  &quot;version&quot;: &quot;1.0.0&quot;,
  &quot;description&quot;: &quot;A tool for cli creation&quot;,
  &quot;main&quot;: &quot;index.js&quot;,
  &quot;scripts&quot;: {
    &quot;pub:beta&quot;: &quot;npm publish --tag=beta&quot;,
    &quot;pub&quot;: &quot;npm publish&quot;
  },
  &quot;publishConfig&quot;: {
    &quot;registry&quot;: &quot;https://registry.npmjs.org/&quot;
  },
  &quot;keywords&quot;: [
    &quot;create&quot;,
    &quot;cli&quot;
  ],
  &quot;author&quot;: &quot;your name&quot;,
  &quot;license&quot;: &quot;ISC&quot;
}
</code></pre>
<h1 id="å¼€å§‹é€ è½®å­">å¼€å§‹é€ è½®å­</h1>
<h2 id="ç¬¬ä¸€æ­¥å®šä¹‰å‘½ä»¤">ç¬¬ä¸€æ­¥ï¼šå®šä¹‰å‘½ä»¤</h2>
<p>ç›¸ä¿¡å¤§å®¶éƒ½ç”¨è¿‡è„šæ‰‹æ¶ï¼Œè„šæ‰‹æ¶å·¥å…·ä¸€èˆ¬éƒ½ä¼šæä¾›ç›¸åº”çš„è„šæœ¬å‘½ä»¤ä»¥å®Œæˆä¸€äº›æ“ä½œã€‚æ¯”å¦‚æŸ¥çœ‹ç‰ˆæœ¬å·çš„ <code>--version</code>, æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯çš„ <code>--help</code> ç­‰ç­‰ã€‚åœ¨è¿™ä¸€æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå…ˆæ¥å®šä¹‰ä¸‹å±äºæˆ‘ä»¬è‡ªå·±è„šæ‰‹æ¶çš„å‘½ä»¤ã€‚</p>
<h3 id="åˆ›å»ºè„šæœ¬æ–‡ä»¶">åˆ›å»ºè„šæœ¬æ–‡ä»¶</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹åˆ›å»º <code>bin</code> ç›®å½•ï¼Œç„¶ååœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºå®šä¹‰è„šæœ¬çš„æ–‡ä»¶ <code>ct.js</code>ã€‚åˆ›å»ºå®Œæˆåï¼Œåœ¨ <code>package.json</code> æ–‡ä»¶ä¸­å®šä¹‰å‘½ä»¤å¯¹åº”çš„æ–‡ä»¶ï¼š</p>
<pre><code class="language-json">{
  // ...
  &quot;bin&quot;: {
    &quot;ct&quot;: &quot;bin/ct.js&quot;
  }
}
</code></pre>
<p>å…¶ä¸­ï¼Œ<code>ct</code> æŒ‡å®šäº†æˆ‘ä»¬æ—¥ååœ¨ä½¿ç”¨è„šæ‰‹æ¶æ—¶æ‰€éœ€è¦è¾“å…¥çš„å‘½ä»¤ï¼Œ<code>bin/ct.js</code> æŒ‡å®šè¾“å…¥å‘½ä»¤åæ‰€æ‰§è¡Œçš„è„šæœ¬æ–‡ä»¶è·¯å¾„ã€‚</p>
<h3 id="ç¼–å†™è„šæœ¬">ç¼–å†™è„šæœ¬</h3>
<p>æˆ‘ä»¬åœ¨è„šæœ¬ä¸­å®šä¹‰ä»¥ä¸‹ä¸¤ä¸ªåŸºæœ¬çš„å‘½ä»¤ï¼š</p>
<pre><code>1. ç”¨äºæŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯çš„å‘½ä»¤ï¼š--version/-v
2. ç”¨äºåˆ›å»ºé¡¹ç›®çš„å‘½ä»¤ï¼š--create/-c
</code></pre>
<pre><code class="language-js">#! /usr/bin/env node

const process = require('process')
const packageJson = require('../package.json')

/*
* æ¥æ”¶å‘½ä»¤è¡Œä¼ è¿‡æ¥çš„æŒ‡ä»¤å‚æ•°
* ç”±äºç¬¬ä¸€ç¬¬äºŒä¸ªä¸ºpathä¿¡æ¯ï¼Œæˆ‘ä»¬ç”¨ä¸åˆ°ï¼Œæ‰€ä»¥ä»ç¬¬ä¸‰ä¸ªå¼€å§‹å–
*/
const argvs = process.argv.slice(2)

switch (argvs[0] || '-c') {
    /** æŸ¥çœ‹å½“å‰æ’ä»¶ç‰ˆæœ¬ */
    case '-v':
    case '--version':
      console.log(`v${packageJson.version}`)
      break
    /** åˆ›å»ºé¡¹ç›® */
    case '-c':
    case '--create':
      console.log('Create project')
      break
}
</code></pre>
<p>ç¼–å†™å®Œæˆåï¼Œå¦‚æœæƒ³è¦åœ¨å‘½ä»¤è¡Œä¸­è¿›è¡ŒéªŒè¯ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code>npm link
</code></pre>
<p>ç„¶ååœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥</p>
<pre><code>ct -v
</code></pre>
<p>ä¹‹åæˆ‘ä»¬ä¾¿å¯ä»¥åœ¨å‘½ä»¤è¡Œå·¥å…·ä¸­çœ‹åˆ°æ‰“å°å‡ºçš„ç‰ˆæœ¬ä¿¡æ¯äº†ï¼š</p>
<figure data-type="image" tabindex="1"><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/64ceba3fbadc4f4abe059babe25415a2~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></figure>
<p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬åŸºæœ¬çš„å‘½ä»¤å®šä¹‰ç¯èŠ‚å°±å®Œæˆäº†ã€‚</p>
<h2 id="ç¬¬äºŒæ­¥å®ç°é¡¹ç›®åˆ›å»ºé€»è¾‘">ç¬¬äºŒæ­¥ï¼šå®ç°é¡¹ç›®åˆ›å»ºé€»è¾‘</h2>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦å¼€å§‹åˆ›å»ºé¡¹ç›®äº†ã€‚åœ¨å¼€å§‹å®ç°å…·ä½“é€»è¾‘ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ‹ä¸€ä¸‹å¯èƒ½ä¼šç»å†å“ªäº›æ­¥éª¤ï¼š</p>
<pre><code>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºé¡¹ç›®
ç¬¬äºŒæ­¥ï¼šåˆ›å»ºé¡¹ç›®æ‰€éœ€åŸºæœ¬æ–‡ä»¶ä»¥åŠæ–‡ä»¶å¤¹ã€‚æ¯”å¦‚ package.json æ–‡ä»¶ï¼Œsrc ç›®å½•ç­‰
ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºå®Œæˆåï¼Œè·³è½¬åˆ°å¯¹åº”çš„ç›®å½•ä¸‹æ‰§è¡Œå®‰è£…æ­¥éª¤
</code></pre>
<p>åŸºäºä»¥ä¸Šçš„å‡ ä¸ªæ­¥éª¤ï¼Œæˆ‘ä»¬æ¥å®ç°å…·ä½“çš„é€»è¾‘ã€‚</p>
<h3 id="åˆ›å»ºé¡¹ç›®">åˆ›å»ºé¡¹ç›®</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨ <code>src/create</code> è·¯å¾„ä¸‹ï¼Œåˆ›å»º <code>index.js</code> æ–‡ä»¶ï¼Œç”¨äºç¼–å†™å…·ä½“çš„åˆ›å»ºé€»è¾‘ã€‚</p>
<pre><code class="language-js">module.exports.run = () =&gt; {}
</code></pre>
<p>ä¹‹åï¼Œæˆ‘ä»¬åœ¨ <code>bin/ct.js</code> æ–‡ä»¶ä¸­å¼•å…¥ï¼Œå¹¶åœ¨æ‰§è¡Œ <code>-c/--create</code> æ—¶è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼š</p>
<pre><code class="language-js">const { run } = require('../src/create/index')

// ....çœç•¥å¥½å¤šå¥½å¤šä»£ç 

/** åˆ›å»ºåŒ…é¡¹ç›® */
case '-c':
case '--create':
  run()
  break

// ....çœç•¥å¥½å¤šå¥½å¤šä»£ç 
</code></pre>
<p>å‚ç…§ <code>vue-cli</code> çš„æ¨¡å¼ï¼Œåœ¨åˆ›å»ºé¡¹ç›®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>äº¤äº’å¼å‘½ä»¤</code> çš„æ–¹å¼è®©åˆ›å»ºçš„è¿‡ç¨‹æ›´åŠ å‹å¥½ã€‚è¿™é‡Œæˆ‘ä»¬ä¼šä½¿ç”¨åˆ°ä¸€ä¸ªåŒ…ï¼š<a href="https://www.npmjs.com/package/inquirer">inquirer</a>ã€‚é€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥å®šä¹‰äº¤äº’å¼å‘½ä»¤ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨æœ¬åœ°å¯¹å…¶è¿›è¡Œå®‰è£…</p>
<pre><code>yarn add -D inquirer
</code></pre>
<p>ä¹‹åï¼Œæˆ‘ä»¬åœ¨ <code>src/constants</code> ç›®å½•ä¸‹ï¼Œåˆ›å»º <code>questions.js</code>ï¼Œç”¨äºå®šä¹‰å…·ä½“çš„æ­¥éª¤ï¼š</p>
<pre><code class="language-js">/**
 * å®šä¹‰äº¤äº’å¼å‘½ä»¤è¡Œçš„é—®é¢˜
 */
const DEFAULT_QUESTIONS = [{
  type: 'input',
  name: 'PROJECT_NAME',
  message: 'Project name:',
  validate: function (name) {
    const done = this.async()
    // å¦‚æœç›®å½•å·²ç»å­˜åœ¨ï¼Œæç¤ºä¿®æ”¹ç›®å½•åç§°
    if (['', null, undefined].includes(name)) {
      done('Please enter the project name!', true)
      return
    }
    if (fs.existsSync(name)) {
      done(`The directory &quot;${name}&quot; is exist!!Please reset the dirname.`, true)
      return
    }
    done(null, true)
  }
}, {
  type: 'input',
  name: 'PROJECT_DESCRIPTION',
  message: 'Project description:'
}, {
  type: 'input',
  name: 'PROJECT_AUTHOR',
  message: 'Project author:'
}]

module.exports = { DEFAULT_QUESTIONS }
</code></pre>
<p>è¿™é‡Œå¯¹ç”¨åˆ°çš„é…ç½®é¡¹åšä¸‹ç®€å•çš„è§£é‡Šï¼Œå…³äºæ›´å¤šå…¶ä»–çš„é…ç½®é¡¹ï¼Œæœ‰å…´è¶£çš„å°ä¼™ä¼´å¯ä»¥<a href="https://www.npmjs.com/package/inquirer#examples">æˆ³</a>ï¼š</p>
<pre><code> type ${string} äº¤äº’ç±»å‹
 name ${string} ç”¨æ¥æ¥æ”¶ç”¨æˆ·è¾“å…¥å†…å®¹çš„key
 message ${string} äº¤äº’ä¿¡æ¯
 validate ${function} æ ¡éªŒæ–¹æ³•
</code></pre>
<p>åˆ›å»ºå®Œæˆåï¼Œåœ¨ <code>src/create/index.js</code> ä¸­å¼•å…¥ <code>inquirer</code> ä»¥åŠä¸Šè¿°å®šä¹‰çš„äº¤äº’æ­¥éª¤ï¼š</p>
<pre><code class="language-js">const inquirer = require('inquirer')
const { DEFAULT_QUESTIONS } = require('../constants/questions')

module.exports.run = async () =&gt; {
  try {
    // è·å–è¾“å…¥çš„ä¿¡æ¯
    const answers = await inquirer.prompt(DEFAULT_QUESTIONS)
  } catch (error) {
    console.log(chalk.red(`Create objet defeat! The error message is: ${error}`))
  }
}
</code></pre>
<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬åœ¨æ§åˆ¶å°ä¸­æ‰§è¡Œ <code>ct -c</code> å‘½ä»¤æ—¶ï¼Œä¾¿å¯ä»¥çœ‹åˆ°äº¤äº’å¼çš„è¾“å…¥ç•Œé¢ï¼š</p>
<figure data-type="image" tabindex="2"><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/be16805e94dd4db7a1460e67f9a709cb~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></figure>
<p>è¾“å…¥å®Œæˆåï¼Œæˆ‘ä»¬å°† <code>answers</code> è¾“å‡ºåˆ°æ§åˆ¶å°ï¼š</p>
<figure data-type="image" tabindex="3"><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f876a4cdd8454452b748190157a7fb17~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></figure>
<p>ç»“æœæ˜¯æˆ‘ä»¬è¾“å…¥çš„å†…å®¹ï¼Œå¯¹åº”çš„keyæ˜¯æˆ‘ä»¬åœ¨è‡ªå®šä¹‰é—®é¢˜æ—¶è®¾ç½®çš„nameå±æ€§ã€‚æˆ‘ä»¬å¯ä»¥é’ˆå¯¹è¾“å…¥çš„ <code>PROJECT_NAME</code> å±æ€§ï¼Œåˆ›å»ºå¯¹åº”çš„é¡¹ç›®æ–‡ä»¶å¤¹ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡nodejsä¸­æä¾›çš„ <code>fs.mkdir</code> çš„æ–¹å¼æ¥åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œè¿™é‡Œæˆ‘æ¨èç»™å¤§å®¶ä¸€ä¸ªè°·æ­Œå¼€æºçš„åº“ï¼š<a href="https://www.npmjs.com/package/zx">zx</a>ã€‚è¿™ä¸ªåº“å°è£…äº†ä¸€ç³»åˆ—çš„shellå‘½ä»¤ï¼Œä»¥ä¾¿è®©æˆ‘ä»¬å¯ä»¥åƒåœ¨æ§åˆ¶å°ä¸­ä¸€æ ·ä½¿ç”¨å‘½ä»¤ï¼š</p>
<pre><code>yarn add -D zx
</code></pre>
<p>å›åˆ° <code>src/create/index.js</code> æ–‡ä»¶ï¼Œæˆ‘ä»¬åœ¨å…¶ä¸­å¼•å…¥ <code>zx</code>ï¼Œå¹¶é€šè¿‡å®ƒåˆ›å»ºæˆ‘ä»¬çš„é¡¹ç›®æ–‡ä»¶å¤¹ã€‚<strong>æ³¨æ„ï¼šåœ¨ä½¿ç”¨zxæ—¶ï¼Œéœ€è¦åœ¨æ–‡ä»¶é¡¶éƒ¨æŒ‡æ˜ <code>#!/usr/bin/env zx</code></strong>ï¼š</p>
<pre><code class="language-js">#!/usr/bin/env zx
// ....çœç•¥å¥½å¤šå¥½å¤šä»£ç 

const answers = await inquirer.prompt(questions)
// åˆ›å»ºæ–°çš„ç›®å½•
await $`mkdir ${answers.PROJECT_NAME}`

// ....çœç•¥å¥½å¤šå¥½å¤šä»£ç 
</code></pre>
<h3 id="åˆ›å»ºå¸¸ç”¨çš„æ–‡ä»¶">åˆ›å»ºå¸¸ç”¨çš„æ–‡ä»¶</h3>
<p>åœ¨å¼€å§‹è¿™ä¸ªæ­¥éª¤å‰ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ€è€ƒä¸‹ï¼Œåœ¨æ–°å»ºä¸€ä¸ªé¡¹ç›®çš„æ—¶å€™ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æ–‡ä»¶å¯èƒ½ä¼šæœ‰å“ªäº›ï¼Ÿç›¸ä¿¡å°ä¼™ä¼´ä»¬çš„å¿ƒé‡Œéƒ½æœ‰è‡ªå·±çš„ç­”æ¡ˆã€‚</p>
<p>åœ¨è¿™é‡Œï¼Œæˆ‘å°†åˆ›å»ºåŒ…æ‹¬ <code>package.json</code>ã€<code>.gitignore</code>ã€<code>src/index.js</code> ç­‰æ–‡ä»¶ï¼Œå¹¶äº‹å…ˆå°†æ–‡ä»¶å†…å®¹æ¨¡æ¿å®šä¹‰åœ¨ <code>src/create/constants/defaultInit.js</code>ä¸­ï¼š</p>
<pre><code class="language-js">// å®šä¹‰index.jså†…å®¹
const INDEX_CONTENT = {
    filename: 'src/index.js',
    content: ''
}
// å®šä¹‰package.jsonå†…å®¹
const PACKAGE_CONTENT = {
    filename: 'package.json',
    content: JSON.stringify({
        &quot;version&quot;: &quot;1.0.0&quot;,
        &quot;main&quot;: &quot;index.js&quot;,
        &quot;scripts&quot;: {
            &quot;ca&quot;: &quot;git add -A &amp;&amp; git-cz -av&quot;,
            &quot;commit&quot;: &quot;git-cz&quot;
        },
        &quot;keywords&quot;: [],
        &quot;license&quot;: &quot;ISC&quot;,
        &quot;devDependencies&quot;: {
            &quot;husky&quot;: &quot;^5.0.9&quot;,
            &quot;commitizen&quot;: &quot;^4.2.3&quot;,
            &quot;cz-conventional-changelog&quot;: &quot;^3.3.0&quot;,
            &quot;lint-staged&quot;: &quot;^10.5.4&quot;
        }
    })
}

// å®šä¹‰.czrcå†…å®¹
const CZRC_CONTENT = {
    filename: '.czrc',
    content: '{ &quot;path&quot;: &quot;cz-conventional-changelog&quot; }'
}
// å®šä¹‰.huskyrcå†…å®¹
const HUSKYRC_CONTENT = {
    filename: '.huskyrc.yml',
    content: `hooks:
      pre-commit: lint-staged
      commit-msg: 'commitlint -E HUSKY_GIT_PARAMS'
    `
}
// å®šä¹‰.commitlintrcå†…å®¹
const COMMITLINTRC_CONTENT = {
    filename: '.commitlintrc.yml',
    content: `extends:
      - '@commitlint/config-conventional'
    `
}
// å®šä¹‰.lintstagedrcå†…å®¹
const LINTSTAGEDRC_CONTENT = {
    filename: '.lintstagedrc.yml',
    content: `'**/*.{js, jsx, vue}':
      - 'eslint --fix'
      - 'git add'
    '**/*.{less, md}':
      - 'prettier --write'
      - 'git add'
    `
}

// å®šä¹‰.gitignore
const GIT_IGNORE_CONTENT = {
    filename: '.gitignore',
    content: '/node_modules'
}

module.exports = {
    INDEX_CONTENT,
    PACKAGE_CONTENT,
    CZRC_CONTENT,
    HUSKYRC_CONTENT,
    COMMITLINTRC_CONTENT,
    LINTSTAGEDRC_CONTENT,
    GIT_IGNORE_CONTENT
}
</code></pre>
<p>è€Œåï¼Œåœ¨ <code>src/create</code> ç›®å½•ä¸‹åˆ›å»º <code>default.js</code>ï¼Œå¹¶å°†æ–‡ä»¶æ¨¡æ¿å¼•å…¥ï¼Œç¼–å†™åˆ›å»ºæ–‡ä»¶çš„é€»è¾‘ã€‚è¯¥æ–‡ä»¶æŠ›å‡ºä¸€ä¸ªæ–¹æ³•ï¼Œæ¥å—ä¸Šä¸€æ­¥éª¤ä¸­çš„é—®é¢˜ç­”æ¡ˆï¼Œå¹¶ä¾æ­¤å°†æ–‡ä»¶å¡«å…¥å¯¹åº”çš„è·¯å¾„ä¸­ã€‚è¯ä¸å¤šè¯´ï¼Œä¸Šä»£ç ï¼š</p>
<pre><code class="language-js">#!/usr/bin/env zx

require('zx/globals')
const {
  INDEX_CONTENT,
  PACKAGE_CONTENT,
  CZRC_CONTENT,
  HUSKYRC_CONTENT,
  COMMITLINTRC_CONTENT,
  LINTSTAGEDRC_CONTENT,
  GIT_IGNORE_CONTENT
} = require('../../constants/defaultInit')

/**
 * å¤åˆ¶templateç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•
 * @param {Object} answers è¾“å…¥çš„ä¿¡æ¯
 */
module.exports = (answers) =&gt; {
    const { PROJECT_NAME } = answers
    const baseDir = `${process.cwd()}/${PROJECT_NAME}`
    // åˆ›å»ºsrcç›®å½•ï¼Œå¹¶åˆ›å»ºindex.jsæ–‡ä»¶
    fs.mkdir(`${baseDir}/src`, { recursive: true }, err =&gt; {
      if (err) {
        console.log({err})
        return
      }
      // åˆ›å»ºæ–‡ä»¶
      const files = [
        INDEX_CONTENT,
        PACKAGE_CONTENT,
        CZRC_CONTENT,
        HUSKYRC_CONTENT,
        COMMITLINTRC_CONTENT,
        LINTSTAGEDRC_CONTENT,
        GIT_IGNORE_CONTENT
      ]
      files.forEach(file =&gt; {
        const { filename, content } = file
        let fileContent = content
        // å¦‚æœæ˜¯package.jsonï¼Œåˆ™å¡«å…¥ç›¸åº”çš„ä¿¡æ¯
        if (filename === 'package.json') {
          const { PROJECT_NAME, PROJECT_DESCRIPTION, PROJECT_AUTHOR } = answers
          const packageContent = {
            name: PROJECT_NAME,
            author: PROJECT_AUTHOR,
            description: PROJECT_DESCRIPTION,
            ...JSON.parse(content)
          }
          fileContent = JSON.stringify(packageContent, null, '\t')
        }
        fs.writeFile(`${baseDir}/${file.filename}`, fileContent, {
          encoding: 'utf-8'
        }, err =&gt; {
          err &amp;&amp; console.log({ type: 'Create index.js failed: ', err })
        })
      })
    })
}
</code></pre>
<p>å†æ¬¡å›åˆ° <code>scr/create/index.js</code> æ–‡ä»¶ä¸­ï¼Œå°†è¯¥æ–¹æ³•å¼•å…¥å¹¶æ‰§è¡Œï¼š</p>
<pre><code class="language-js">const initObject = require('../utils/default')

// ....çœç•¥å¥½å¤šå¥½å¤šä»£ç 

// è·å–è¾“å…¥çš„ä¿¡æ¯
const answers = await inquirer.prompt(questions)
// åˆ›å»ºæ–°çš„ç›®å½•
await $`mkdir ${answers.PROJECT_NAME}`
// åˆ›å»ºæ–‡ä»¶
await initObject(answers)

// ....çœç•¥å¥½å¤šå¥½å¤šä»£ç 
</code></pre>
<h3 id="è·³è½¬åˆ°å¯¹åº”çš„ç›®å½•æ‰§è¡Œå®‰è£…æ“ä½œ">è·³è½¬åˆ°å¯¹åº”çš„ç›®å½•ï¼Œæ‰§è¡Œå®‰è£…æ“ä½œ</h3>
<p>è¿™ä¸€æ­¥å°±å¾ˆç®€å•äº†ï¼Œåªéœ€è¦è·³è½¬åˆ°æˆ‘ä»¬åˆ›å»ºå¥½çš„ç›®å½•ä¸‹ï¼Œå¹¶å®‰è£…æ‰€éœ€çš„åŒ…å³å¯ï¼š</p>
<pre><code class="language-js">// src/create/index.js

// ....çœç•¥å¥½å¤šå¥½å¤šä»£ç 

// è·å–è¾“å…¥çš„ä¿¡æ¯
const answers = await inquirer.prompt(questions)
// åˆ›å»ºæ–°çš„ç›®å½•
await $`mkdir ${answers.PROJECT_NAME}`
// åˆ›å»ºæ–‡ä»¶
await initObject(answers)
// è·³è½¬è‡³ç›®å½•
cd(dirName)
// æ‰§è¡Œå®‰è£…å‘½ä»¤
await $`yarn`

// ....çœç•¥å¥½å¤šå¥½å¤šä»£ç 
</code></pre>
<p>è‡³æ­¤ï¼Œæ‰€æœ‰çš„åŸºæœ¬é€»è¾‘å°±éƒ½å®Œæˆå•¦~</p>
<h2 id="ç¬¬ä¸‰æ­¥å‘å¸ƒè¿™ä¸ªå·¥å…·åˆ°npm">ç¬¬ä¸‰æ­¥ï¼šå‘å¸ƒè¿™ä¸ªå·¥å…·åˆ°npm</h2>
<p>å®Œæˆç¼–å†™åï¼Œæˆ‘ä»¬ç›´æ¥æ‰§è¡Œäº‹å…ˆè®¾ç½®å¥½çš„ <code>pub</code> å‘½ä»¤å‘å¸ƒå³å¯ã€‚</p>
<h1 id="æ‰©å±•é˜…è¯»">æ‰©å±•é˜…è¯»</h1>
<h2 id="å…³äºå‘½ä»¤è§£æ">å…³äºå‘½ä»¤è§£æ</h2>
<p>æœ¬æ–‡ä¸­æˆ‘ä»¬é€šè¿‡ <code>process.argv</code> æ¥è§£æè¾“å…¥çš„å‘½ä»¤ï¼Œå¦‚æœæ˜¯ç®€å•çš„é¡¹ç›®è¿˜å¥½ï¼Œè¦æ˜¯åç»­è„šæ‰‹æ¶åŠŸèƒ½æ—¥ç›Šå¤æ‚ï¼Œè¯¸å¤šå‘½ä»¤è‹¥ä»éœ€è¦é€šè¿‡è¿™ç§æ–¹å¼å»è§£ææœªå…æœ‰äº›ç¹çäº†ï¼Œè¿™é‡Œæ¨èå¤§å®¶ä¸€ä¸ªç¬¬ä¸‰æ–¹åŒ…ï¼š<a href="https://www.npmjs.com/package/commander">commander</a>ï¼Œå®ƒå¯ä»¥è®©è¿™ä¸ªè¿‡ç¨‹æ›´åŠ ç®€ä¾¿ä¸€äº›ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡å®ƒé…ç½® help ä¿¡æ¯ï¼Œæœ‰å…´è¶£çš„å°ä¼™ä¼´å¿«å»è¯•è¯•çœ‹å§~</p>
<h2 id="å…³äºæ‰“å°ä¿¡æ¯çš„é¢œè‰²">å…³äºæ‰“å°ä¿¡æ¯çš„é¢œè‰²</h2>
<p>é’ˆå¯¹ä¸åŒç±»åˆ«çš„æ§åˆ¶å°æ‰“å°ä¿¡æ¯ï¼Œå…¶å®å¯ä»¥è®¾ç½®ç›¸åº”çš„é¢œè‰²ï¼Œè¿™æ ·çœ‹èµ·æ¥æ›´åŠ ç›´è§‚ï¼Œä¹Ÿæ›´åŠ ç¾è§‚ã€‚åœ¨ä¸Šæ–‡ä¸­æåˆ°çš„ <code>zx</code>ä¸­ï¼Œä¹Ÿå°è£…äº† <code>chalk</code>ï¼Œåªè¦å¼•å…¥äº† <code>zx</code> ä¾¿å¯ç›´æ¥ä½¿ç”¨ã€‚é€šè¿‡å®ƒå¯ä»¥ä¸ºæ§åˆ¶å°è¾“å‡ºä¿¡æ¯â€œä¸Šè‰²â€ã€‚ä¸¾ä¸ªğŸŒ°ï¼š</p>
<pre><code class="language-js">console.log(chalk.red(`Create objet defeat! The error message is: ${error}`))
</code></pre>
<p>æ›´å¤šçš„é¢œè‰²è·Ÿä½¿ç”¨æ–¹å¼ï¼Œå°ä¼™ä¼´ä»¬ä¹Ÿå¯ä»¥å»ç ”ç©¶ä¸€ä¸‹ï¼Œè®©æ§åˆ¶å°è¾“å‡ºä¹Ÿå¤šå§¿å¤šå½©èµ·æ¥~</p>
<h1 id="ç»“æŸè¯­">ç»“æŸè¯­</h1>
<p>è¡Œæ–‡è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†ä¸€ä¸ªå±äºè‡ªå·±çš„ç®€å•è„šæ‰‹æ¶å·¥å…·ã€‚å¤§å®¶åæœŸå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚å¯¹å…¶æŒç»­ä¼˜åŒ–ï¼Œä¹Ÿå¯ä»¥æ€è€ƒä¸‹åˆ«çš„å°ä¼™ä¼´åœ¨ä½¿ç”¨ä½ çš„è„šæ‰‹æ¶çš„æ—¶å€™ä¼šéœ€è¦äº›ä»€ä¹ˆï¼Œæ€ä¹ˆåšæ‰å¯ä»¥å¸®åŠ©æ›´å¤šçš„å°ä¼™ä¼´æå‡äººæ•ˆã€‚</p>
<p>å…³äºcliå·¥å…·ï¼Œå´”å¤§åœ¨Bç«™ä¹Ÿæœ‰ä¸€æœŸè¯¦ç»†çš„è®²è§£è§†é¢‘ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥å»å‚è€ƒï¼š<a href="https://www.bilibili.com/video/BV1jK4y197Ne?spm_id_from=333.999.0.0">ä¼ é€é—¨</a></p>
<p>æœ¬æ–‡ä¸­çš„è„šæ‰‹æ¶å·¥å…·å·²ç»ä¸Šä¼ åˆ°<a href="https://github.com/luhaifeng666/cli-create-tool">git</a>, æ¬¢è¿â­ï¸äº¤æµ~</p>
<p>åŒæ—¶ä¹Ÿå·²ä¸Šä¼ è‡³ <a href="https://www.npmjs.com/package/cli-create-tool">npm</a>, æœ‰å…´è¶£çš„å°ä¼™ä¼´ä»¬å¯ä»¥å…¨å±€å®‰è£…å°è¯•ä¸‹~</p>
<p>çœ‹åˆ°è¿™é‡Œï¼Œå¿«åŠ¨æ‰‹ç»‡ä¸ªç½‘å§~</p>

            </div>
            
            <div id="vcomments"></div>
            <span id="comment-count"></span>
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://luhaifeng666.github.io/post/liu-lan-qi-zhong-hao-de-chu-li/">
                  <h3 class="post-title">
                    æµè§ˆå™¨ä¸­+å·çš„å¤„ç†
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>
    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>





  </body>
  <script type="text/javascript">
    // è®¾ç½®valine
    new Valine({
      av: AV,
      el: '#vcomments',
      count_el: '#comment-count',
      appId: 'HlwrEhBsDstpVpKVMUMqyfBV-9Nh9j0Va',
      appKey: 'Cs2jEIpcC6nXJFH8LsEak9Kh',
      placeholder: 'ä½ è¯´ï¼Œæˆ‘åœ¨å¬',
      visitor: true,
      // è®¾ç½®Bilibiliè¡¨æƒ…åŒ…åœ°å€
      emojiCDN: '//i0.hdslb.com/bfs/emote/',
      // è¡¨æƒ…titleå’Œå›¾ç‰‡æ˜ å°„
      emojiMaps: {
        "tv_doge": "6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png",
        "tv_äº²äº²": "a8111ad55953ef5e3be3327ef94eb4a39d535d06.png",
        "tv_å·ç¬‘": "bb690d4107620f1c15cff29509db529a73aee261.png",
        "tv_å†è§": "180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png",
        "tv_å†·æ¼ ": "b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png",
        "tv_å‘æ€’": "34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png",
        "tv_å‘è´¢": "34db290afd2963723c6eb3c4560667db7253a21a.png",
        "tv_å¯çˆ±": "9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png",
        "tv_åè¡€": "09dd16a7aa59b77baa1155d47484409624470c77.png",
        "tv_å‘†": "fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png",
        "tv_å‘•å": "9f996894a39e282ccf5e66856af49483f81870f3.png",
        "tv_å›°": "241ee304e44c0af029adceb294399391e4737ef2.png",
        "tv_åç¬‘": "1f0b87f731a671079842116e0991c91c2c88645a.png",
        "tv_å¤§ä½¬": "093c1e2c490161aca397afc45573c877cdead616.png",
        "tv_å¤§å“­": "23269aeb35f99daee28dda129676f6e9ea87934f.png",
        "tv_å§”å±ˆ": "d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png",
        "tv_å®³ç¾": "a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png",
        "tv_å°´å°¬": "7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png",
        "tv_å¾®ç¬‘": "70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png",
        "tv_æ€è€ƒ": "90cf159733e558137ed20aa04d09964436f618a1.png",
        "tv_æƒŠå“": "0d15c7e2ee58e935adc6a7193ee042388adc22af.png"
      }
    })
  </script>
</html>
